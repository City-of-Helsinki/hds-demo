{"version":3,"file":"component---src-docs-foundation-guidelines-server-side-rendering-mdx-21e6673f22fe9c20ae16.js","mappings":"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","sources":["webpack://site/./src/docs/foundation/guidelines/server-side-rendering.mdx"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/harri.lappalainen/git/helsinki-design-system/site/src/components/layout.js\";\nimport { Accordion, Notification } from 'hds-react';\nimport LeadParagraph from '../../../components/LeadParagraph';\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n\n    <h1 {...{\n      \"id\": \"server-side-rendering\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}>{`Server-side rendering`}<a parentName=\"h1\" {...{\n        \"href\": \"#server-side-rendering\",\n        \"aria-label\": \"server side rendering permalink\",\n        \"className\": \"header-anchor after\"\n      }}><span parentName=\"a\" {...{\n          \"className\": \"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs\",\n          \"aria-hidden\": \"true\",\n          \"style\": {\n            \"verticalAlign\": \"middle\"\n          }\n        }}></span></a></h1>\n    <LeadParagraph mdxType=\"LeadParagraph\">\n  The server-side rendering support of the Helsinki Design System makes the user's landing experience to pages smooth without\n  flashes of unstyled content.\n    </LeadParagraph>\n    <h2 {...{\n      \"id\": \"what-is-server-side-rendering\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}>{`What is server-side rendering?`}<a parentName=\"h2\" {...{\n        \"href\": \"#what-is-server-side-rendering\",\n        \"aria-label\": \"what is server side rendering permalink\",\n        \"className\": \"header-anchor after\"\n      }}><span parentName=\"a\" {...{\n          \"className\": \"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs\",\n          \"aria-hidden\": \"true\",\n          \"style\": {\n            \"verticalAlign\": \"middle\"\n          }\n        }}></span></a></h2>\n    <p>{`Server-side rendering (SSR) is the process where the rendering of HTML pages is done on the server-side. The fully rendered HTML\ndocument is then sent to the browser. The rendering of the HTML can happen at build time (Static site generation\nor pre-rendering), or during an HTTP request. The alternative to SSR is client-side rendering (CSR), where most of the HTML\ncontent is composed and rendered in the browser using JavaScript.`}</p>\n    <h2 {...{\n      \"id\": \"how-does-hds-support-server-side-rendering\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}>{`How does HDS support server-side rendering?`}<a parentName=\"h2\" {...{\n        \"href\": \"#how-does-hds-support-server-side-rendering\",\n        \"aria-label\": \"how does hds support server side rendering permalink\",\n        \"className\": \"header-anchor after\"\n      }}><span parentName=\"a\" {...{\n          \"className\": \"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs\",\n          \"aria-hidden\": \"true\",\n          \"style\": {\n            \"verticalAlign\": \"middle\"\n          }\n        }}></span></a></h2>\n    <p>{`For HDS components to work with server-side rendering, you need to inject the critical CSS styles of the HDS components\nthat are being used into the initially rendered HTML on the server's side. For hds-core, you must include the styles from\nthe provided CSS files yourself. For hds-react HDS provides multiple options, which we will cover next.`}</p>\n    <Notification label=\"Critical CSS\" className=\"siteNotification\" mdxType=\"Notification\">\nCritical CSS is applied to above-the-fold elements. It provides the styles for the immediately visible content in the browser\nviewport when the user opens your website. Critical CSS does not usually have the styles of the elements that are in the\nscrollable content outside of the browser viewport. There is one exception though, and that is if you have anchor links on the page.\nWhen user opens website from an URL that includes an anchor link, the browser automatically scrolls the page so that the link\nwill be visible.\n    </Notification>\n    <h3 {...{\n      \"id\": \"option-1-getcriticalhdsrules-tool-to-get-critical-styles-recommended\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}>{`Option 1: getCriticalHdsRules tool to get critical styles (recommended)`}<a parentName=\"h3\" {...{\n        \"href\": \"#option-1-getcriticalhdsrules-tool-to-get-critical-styles-recommended\",\n        \"aria-label\": \"option 1 getcriticalhdsrules tool to get critical styles recommended permalink\",\n        \"className\": \"header-anchor after\"\n      }}><span parentName=\"a\" {...{\n          \"className\": \"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs\",\n          \"aria-hidden\": \"true\",\n          \"style\": {\n            \"verticalAlign\": \"middle\"\n          }\n        }}></span></a></h3>\n    <p>{`HDS React components use CSS-in-JS in a way where the styles are by default injected into the head tag in the browser.\nIf you use server-side rendering and do not include the critical styles on the server, this leads to flashes of unstyled\ncontent when the user lands on the page.`}</p>\n    <p>{`To include critical styles on the server, HDS exposes a tool for extracting the used critical styles of HDS components.\nThis should come in handy in multiple ways:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Automatically extracts styles based on used HTML.`}</li>\n      <li parentName=\"ul\">{`If you add more HDS components later, you do not need to remember to add their styles separately.`}</li>\n      <li parentName=\"ul\">{`If you happen to remove HDS components, you do not need to remember to remove their respective styles.`}</li>\n    </ul>\n    <p>{`Let's go through a simple example of the usage of the tool:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import { getCriticalHdsRules, hdsStyles } from \"hds-react\";\n\nconst criticalHdsRules = await getCriticalHdsRules(bodyHTML, hdsStyles);\n\nconst finalHTML =\n<html>\n  <head>\n    ...\n    <style data-used-styles dangerouslySetInnerHTML={{ __html: criticalHdsRules }} />\n  </head>\n  <body>\n    ...\n  </body>\n<html>\n`}</code></pre>\n    <p>{`First, we import the tool that is named `}<inlineCode parentName=\"p\">{`getCriticalHdsRules`}</inlineCode>{`. To be able to call it, we need two things:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`The initially to-be-rendered HTML body code as a string.`}</li>\n      <li parentName=\"ol\">{`hdsStyles - a variable holding all the styles of the HDS react components as a string.`}</li>\n    </ol>\n    <p>{`Calling it returns a string containing the critical CSS styles. The rest is easy, we set those styles into\na style tag, that we will then inject into the finally rendered HTML document. It can be wise to cache the result of\n`}<inlineCode parentName=\"p\">{`getCriticalHdsRules`}</inlineCode>{` based on the function parameters in order to improve performance.`}</p>\n    <p>{`See below for more complete examples:`}</p>\n    <Accordion heading=\"Next.js\" headingLevel=\"4\" language=\"en\" size={\"s\"} theme={{\n      '--padding-vertical': 'var(--spacing-s)'\n    }} mdxType=\"Accordion\">\n  In the Next.js framework, create a file called _document.js in folder pages, and add this code to it:\n      <pre><code parentName=\"pre\" {...{\n          \"className\": \"language-js\"\n        }}>{`// pages/_document.js - tested with next.js version: 10.0.5\nimport Document, { Html, Head, Main, NextScript } from 'next/document'\nimport { getCriticalHdsRules, hdsStyles } from 'hds-react';\n\nclass MyDocument extends Document {\n  static async getInitialProps(ctx) {\n    const initialProps = await Document.getInitialProps(ctx)\n    const hdsCriticalRules = await getCriticalHdsRules(initialProps.html, hdsStyles);\n\n    return {...initialProps, hdsCriticalRules}\n  }\n\n  render() {\n    return (\n      <Html>\n        <Head>\n          <style data-used-styles dangerouslySetInnerHTML={{ __html: this.props.hdsCriticalRules }} />\n        </Head>\n        <body>\n          <Main />\n          <NextScript />\n        </body>\n      </Html>\n    )\n  }\n}\n\nexport default MyDocument\n`}</code></pre>\n    </Accordion>\n    <Accordion heading=\"Gatsby\" headingLevel=\"4\" language=\"en\" size={\"s\"} theme={{\n      '--padding-vertical': 'var(--spacing-s)'\n    }} mdxType=\"Accordion\">\n  In the Gatsby framework, create a file called gatsby-ssr.js at the root of the project, and add this code to it:\n      <pre><code parentName=\"pre\" {...{\n          \"className\": \"language-js\"\n        }}>{`// gatsby-ssr.js - tested with gatsby version 4.17.0\nimport React from 'react';\nimport { getCriticalHdsRules, hdsStyles } from 'hds-react';\nimport { renderToString } from 'react-dom/server';\n\nexport const replaceRenderer = async ({ bodyComponent, setHeadComponents }) => {\n  const bodyHTML = renderToString(bodyComponent);\n\n  if (hdsStyles && hdsStyles.length > 0 && bodyHTML && bodyHTML.length > 0) {\n    const cssRules = await getCriticalHdsRules(bodyHTML, hdsStyles);\n    const HeadComponents = [\n      <style data-used-styles dangerouslySetInnerHTML={{ __html: cssRules }} />\n    ];\n\n    return setHeadComponents(HeadComponents);\n  }\n\n  return;\n}\n`}</code></pre>\n    </Accordion>\n    <h3 {...{\n      \"id\": \"option-2-use-indexcss-or-hdsstyles-not-recommended\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}>{`Option 2: Use index.css or hdsStyles (not recommended)`}<a parentName=\"h3\" {...{\n        \"href\": \"#option-2-use-indexcss-or-hdsstyles-not-recommended\",\n        \"aria-label\": \"option 2 use indexcss or hdsstyles not recommended permalink\",\n        \"className\": \"header-anchor after\"\n      }}><span parentName=\"a\" {...{\n          \"className\": \"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs\",\n          \"aria-hidden\": \"true\",\n          \"style\": {\n            \"verticalAlign\": \"middle\"\n          }\n        }}></span></a></h3>\n    <p>{`HDS react provides all the styles of HDS components in a file called `}<inlineCode parentName=\"p\">{`index.css`}</inlineCode>{`, located at the root of the library.\nYou can import that file and collect the critical CSS styles from there. Another alternative is to use exported variable\ncalled `}<inlineCode parentName=\"p\">{`hdsStyles`}</inlineCode>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import { hdsStyles } from 'hds-react';\n`}</code></pre>\n    <p>{`This variable holds all the styles of HDS React components compiled into a single string. It might be tempting to include\nall the styles in `}<inlineCode parentName=\"p\">{`hdsStyles`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`index.css`}</inlineCode>{` to your HTML, and call it a day. This is not optimal because the size of the\nHDS styles is large and probably growing as new components are added to it. Adding all the styles might have an impact on the\nperformance of the app. Instead, you should collect only the necessary styles for the initial render. We recommend using\nthe tool described in option 1. But if you are unable to use that, extracting the critical CSS styles from either\n`}<inlineCode parentName=\"p\">{`hdsStyles`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`index.css`}</inlineCode>{` might work out for you.`}</p>\n    <h3 {...{\n      \"id\": \"customising-hds-components-and-server-side-rendering\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}>{`Customising HDS components and server-side rendering`}<a parentName=\"h3\" {...{\n        \"href\": \"#customising-hds-components-and-server-side-rendering\",\n        \"aria-label\": \"customising hds components and server side rendering permalink\",\n        \"className\": \"header-anchor after\"\n      }}><span parentName=\"a\" {...{\n          \"className\": \"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs\",\n          \"aria-hidden\": \"true\",\n          \"style\": {\n            \"verticalAlign\": \"middle\"\n          }\n        }}></span></a></h3>\n    <p>{`If you customise hds-react components with the `}<code>{`theme`}</code>{` prop, the style changes will not be visible on the\nfirst render. The preferred way to customise hds-react components with server-side rendering is using the `}<code>{`className`}</code>{`\nprop. However, notice that sometimes CSS selector specificity of 0-1-0 may not be enough to overwrite default CSS variables.\nThis depends on the CSS declaration order on the page or component's default styles selector specificity.\nYou may have to use a more specific CSS selector for the custom styles class, for example, `}<inlineCode parentName=\"p\">{`#myComponent.custom-class`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`.custom-class.custom-class`}</inlineCode>{`, etc.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","_ref","components","props","_objectWithoutPropertiesLoose","_excluded","mdx","Object","assign","mdxType","parentName","LeadParagraph","Notification","label","className","Accordion","heading","headingLevel","language","size","theme","isMDXComponent"],"sourceRoot":""}