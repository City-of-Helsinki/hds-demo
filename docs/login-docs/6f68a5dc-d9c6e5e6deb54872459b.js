"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[3105],{74426:function(e,t,n){n.d(t,{$:function(){return Dn},A:function(){return Ke},B:function(){return Ve},C:function(){return ze},D:function(){return Qe},E:function(){return Je},F:function(){return Ye},G:function(){return Me},H:function(){return te},I:function(){return De},J:function(){return Ue},K:function(){return Ce},L:function(){return tt},M:function(){return Rn},N:function(){return qn},O:function(){return Gn},P:function(){return Kn},Q:function(){return Wn},R:function(){return zn},S:function(){return jn},T:function(){return Hn},U:function(){return Zn},V:function(){return Fn},W:function(){return Vn},X:function(){return An},Y:function(){return Ln},Z:function(){return Pn},_:function(){return Un},a:function(){return xe},a$:function(){return Bt},a0:function(){return Mn},a1:function(){return Sr},a2:function(){return Er},a3:function(){return br},a4:function(){return Wr},a5:function(){return Kr},a6:function(){return rt},a7:function(){return it},a8:function(){return ot},a9:function(){return st},aA:function(){return ur},aB:function(){return cr},aC:function(){return dr},aD:function(){return lr},aE:function(){return fr},aF:function(){return pr},aG:function(){return _r},aH:function(){return hr},aI:function(){return gr},aJ:function(){return vr},aK:function(){return mr},aL:function(){return wr},aM:function(){return Nt},aN:function(){return Ot},aO:function(){return Tt},aP:function(){return Rt},aQ:function(){return At},aR:function(){return Lt},aS:function(){return Pt},aT:function(){return Ct},aU:function(){return Ut},aV:function(){return Dt},aW:function(){return Mt},aX:function(){return jt},aY:function(){return Ht},aZ:function(){return Zt},a_:function(){return Ft},aa:function(){return at},ab:function(){return ut},ac:function(){return bn},ad:function(){return kn},ae:function(){return yn},af:function(){return xn},ag:function(){return In},ah:function(){return Nn},ai:function(){return On},aj:function(){return Tn},ak:function(){return hn},al:function(){return gn},am:function(){return ge},an:function(){return ve},ao:function(){return St},ap:function(){return Et},aq:function(){return Xn},ar:function(){return $n},as:function(){return er},at:function(){return tr},au:function(){return nr},av:function(){return rr},aw:function(){return ir},ax:function(){return or},ay:function(){return sr},az:function(){return ar},b:function(){return ye},b0:function(){return qt},b1:function(){return Gt},b2:function(){return Wt},b3:function(){return Kt},b4:function(){return Vt},b5:function(){return zt},b6:function(){return Qt},b7:function(){return Jt},b8:function(){return Yt},b9:function(){return Xt},bA:function(){return Fr},bB:function(){return Br},bC:function(){return qr},bD:function(){return Gr},ba:function(){return $t},bb:function(){return en},bc:function(){return tn},bd:function(){return nn},be:function(){return rn},bf:function(){return on},bg:function(){return sn},bh:function(){return an},bi:function(){return un},bj:function(){return cn},bk:function(){return dn},bl:function(){return Ir},bm:function(){return Nr},bn:function(){return Or},bo:function(){return Tr},bp:function(){return Rr},bq:function(){return Ar},br:function(){return Lr},bs:function(){return Pr},bt:function(){return Cr},bu:function(){return Ur},bv:function(){return Dr},bw:function(){return Mr},bx:function(){return jr},by:function(){return Hr},bz:function(){return Zr},c:function(){return pn},d:function(){return Sn},e:function(){return _e},f:function(){return Vr},g:function(){return wn},h:function(){return pe},i:function(){return ln},j:function(){return Oe},k:function(){return Ie},l:function(){return Ne},m:function(){return Te},n:function(){return Re},o:function(){return he},p:function(){return Le},q:function(){return Pe},r:function(){return je},s:function(){return fn},t:function(){return He},u:function(){return Ze},v:function(){return Fe},w:function(){return Be},x:function(){return qe},y:function(){return We},z:function(){return Ge}});var r=n(4942),i=n(63366),o=n(15861),s=n(42982),a=n(72407),u=n(43144),c=n(94236),d=n(94578),l=n(36459),f=n(64687),p=n.n(f),_=(n(65743),n(17727),n(67294)),h=n(7444),g=n(44458),v=n(92017),m=n(38658),w=n(16839),S=n(98215),E=n(41752),b=n(69385),k=n(24337),y=n(95789),x=n(8691),I=["timeoutInSeconds"],N=["grant_type","redirect_uri","client_id","client_secret"],O=["grant_type","client_id","client_secret","scope"],T=["grant_type","client_id","client_secret","timeoutInSeconds"],R=["url","authority","client_id","redirect_uri","response_type","scope","state_data","response_mode","request_type","client_secret","nonce","resource","skipUserInfo","extraQueryParams","extraTokenParams","disablePKCE"],A=["redirectMethod"],L=["popupWindowFeatures","popupWindowTarget"],P=["silentRequestTimeoutInSeconds"],C=["silentRequestTimeoutInSeconds"],U=["redirectMethod"],D=["popupWindowFeatures","popupWindowTarget"],M=["silentRequestTimeoutInSeconds"];function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,h.s)(".Header-module_header__291GF{--header-height:var(--spacing-4-xl);--header-focus-outline-width:3px;--header-focus-outline-border-radius:0;--header-z-index:10;--header-focus-outline-color:var(--color-coat-of-arms);background-color:var(--navigation-row-background-color);color:var(--header-color);position:relative;width:100%}.Header-module_headerBackgroundWrapper__KsFy2{position:relative;z-index:var(--header-z-index)}");var B=(0,_.createContext)({}),q={xs:320,s:576,m:768,l:992,xl:1248},G=function(e){return function(e){var t=(0,_.useState)(!1),n=t[0],r=t[1],i=(0,_.useRef)(n);return(0,_.useEffect)((function(){var t=function(){var t;t=e(),i.current!==t&&(i.current=t,r(t))};return window.addEventListener("resize",t),t(),function(){return window.removeEventListener("resize",t)}}),[]),n}((function(){return t=q[e],void 0!==(n="undefined"!=typeof window&&window.innerWidth?window.innerWidth:void 0)&&n<t||!1;var t,n}))},W="HeaderUniversalBar-module_universalBarLink___6ZN5";(0,h.s)(".HeaderUniversalBar-module_headerUniversalBar__1WF8C{align-items:center;background:var(--color-black-5);box-sizing:border-box;display:flex;min-height:48px;padding:0 var(--spacing-m);width:100%}.HeaderUniversalBar-module_headerUniversalBarList__1ci3u{display:flex;gap:0 var(--spacing-l);list-style:none;margin:0;padding:0;width:100%}.HeaderUniversalBar-module_universalBarMainLinkContainer__xZGVq{display:flex;flex:1;justify-self:start}.HeaderUniversalBar-module_universalBarSecondaryLinkContainer__3itUq{display:flex;justify-self:end}.HeaderUniversalBar-module_universalBarSecondaryLinkContainer__3itUq:last-child{margin-right:0}.HeaderUniversalBar-module_universalBarLink___6ZN5.HeaderUniversalBar-module_universalBarLink___6ZN5{font-size:var(--fontsize-body-m)}@media only screen and (max-width:767.98px){.HeaderUniversalBar-module_headerUniversalBarList__1ci3u{gap:0 var(--spacing-m)}}@media only screen and (max-width:575.98px){.HeaderUniversalBar-module_universalBarLink___6ZN5.HeaderUniversalBar-module_universalBarLink___6ZN5{font-size:var(--fontsize-body-s)}}");(0,h.s)(".NavigationLink-module_navigationLink__3Vf_4.NavigationLink-module_navigationLink__3Vf_4{--link-visited-color:none;--link-color:var(--color-black-90)}.NavigationLink-module_active__2xtqj{font-weight:700}.NavigationLink-module_navigationLink__3Vf_4:focus,.NavigationLink-module_navigationLink__3Vf_4:hover{text-decoration:underline;text-decoration-color:var(--color-black-90)}.NavigationLink-module_navigationLinkWrapper__11IwF{align-items:center;display:flex;height:100%;position:relative}.NavigationLink-module_navigationLinkWrapper__11IwF .NavigationLink-module_navigationLink__3Vf_4{--link-visited-color:none;--link-color:var(--color-black-90);display:flex;flex-grow:1;line-height:var(--lineheight-l);text-decoration:none;word-wrap:break-word}");var K,V,z,Q={navigationLinkDropdownContainer:"NavigationLinkDropdown-module_navigationLinkDropdownContainer__3c_Sx",chevron:"NavigationLinkDropdown-module_chevron__NeVqa",chevronOpen:"NavigationLinkDropdown-module_chevronOpen__1rLOJ",hidden:"NavigationLinkDropdown-module_hidden__38mZg",dropdownMenu:"NavigationLinkDropdown-module_dropdownMenu__1ncjR",dropdownLink:"NavigationLinkDropdown-module_dropdownLink__nPxRB",activeLink:"NavigationLinkDropdown-module_activeLink__2RijD",left:"NavigationLinkDropdown-module_left__29Mlr",right:"NavigationLinkDropdown-module_right__13lu_",button:"NavigationLinkDropdown-module_button__25jTb"};(0,h.s)('.NavigationLinkDropdown-module_navigationLinkDropdownContainer__3c_Sx{outline:none}.NavigationLinkDropdown-module_chevron__NeVqa{transition:transform .2s ease-in}.NavigationLinkDropdown-module_chevronOpen__1rLOJ{transform:rotate(180deg)}.NavigationLinkDropdown-module_hidden__38mZg{display:none}.NavigationLinkDropdown-module_dropdownMenu__1ncjR{background-color:var(--color-white);border:1px solid var(--color-black-20);display:flex;flex-direction:column;left:-10px;list-style:none;min-width:280px;padding:0;position:absolute;top:100%;z-index:1}.NavigationLinkDropdown-module_dropdownMenu__1ncjR .NavigationLinkDropdown-module_dropdownLink__nPxRB{font-size:var(--fontsize-body-l);margin:0;padding:10px var(--spacing-s) 14px var(--spacing-s)}.NavigationLinkDropdown-module_dropdownMenu__1ncjR .NavigationLinkDropdown-module_activeLink__2RijD:before{border-left:4px solid var(--color-black);padding-left:var(--spacing-xs)}.NavigationLinkDropdown-module_dropdownMenu__1ncjR .NavigationLinkDropdown-module_dropdownLink__nPxRB:before{bottom:0;content:"";height:100%;left:0;margin:0;position:absolute;width:0}.NavigationLinkDropdown-module_dropdownMenu__1ncjR .NavigationLinkDropdown-module_dropdownLink__nPxRB:hover:before{border-left:4px solid var(--color-black);transition:border-left .1s ease-in}.NavigationLinkDropdown-module_left__29Mlr{left:auto;right:calc(100% + 2px);top:-1px}.NavigationLinkDropdown-module_right__13lu_{left:calc(100% + 2px);right:auto;top:-1px}.NavigationLinkDropdown-module_button__25jTb{background-color:var(--color-black-5);border:none;box-sizing:content-box;display:block;height:24px;padding:3px;width:24px}.NavigationLinkDropdown-module_button__25jTb:hover{background-color:var(--color-black-20);cursor:pointer}.NavigationLinkDropdown-module_button__25jTb:focus{border:3px solid var(--color-coat-of-arms);margin:0;outline:none;padding:0}'),(z=K||(K={})).Hover="hover",z.Click="click",function(e){e.Left="left",e.Right="right"}(V||(V={}));var J=function(e){var t=e.children,n=e.dynamicPosition,r=void 0===n?V.Right:n,i=e.index,o=e.open,s=e.setOpen,a=(0,_.useState)(-1),u=a[0],c=a[1],d=(0,_.useRef)(null),l=o?(0,g.c)(Q.chevron,Q.chevronOpen):Q.chevron,f=r?(0,g.c)(Q.dropdownMenu,Q[r]):Q.dropdownMenu;return _.createElement("div",{className:Q.navigationLinkDropdownContainer},_.createElement("button",{type:"button",className:Q.button,onClick:function(){return s(!o,K.Click)},"data-testid":"dropdown-button-"+i},_.createElement(m.I,{className:l})),_.createElement("ul",Object.assign({className:f},!o&&{style:{display:"none"}},{"data-testid":"dropdown-menu-"+i,ref:d}),_.Children.map(t,(function(e,t){return _.createElement("li",{key:i},(0,_.isValidElement)(e)?(0,_.cloneElement)(e,{index:t,openSubNavIndex:u,setOpenSubNavIndex:c,className:e.props.active?(0,g.c)(Q.dropdownLink,Q.activeLink):Q.dropdownLink}):e)}))))};J.componentName="HDSNavigationLinkDropdown";var Y,X=(0,_.createContext)({});!function(e){e.Down="Down",e.Dynamic="Dynamic"}(Y||(Y={}));var $=function(e){var t=e.active,n=e.className,r=e.dropdownDirection,i=void 0===r?Y.Down:r,o=e.dropdownLinks,s=e.href,a=e.index,u=e.label,c=e.openSubNavIndex,d=e.setOpenSubNavIndex,l=(0,v._)(e,["active","className","dropdownDirection","dropdownLinks","href","index","label","openSubNavIndex","setOpenSubNavIndex"]),f=(0,_.useState)(!1),p=f[0],h=f[1],m=(0,_.useState)(null),S=m[0],E=m[1],b=(0,_.useState)(null),k=b[0],y=b[1],x=(0,_.useContext)(X),I=x.openMainNavIndex,N=x.setOpenMainNavIndex,O=(0,_.useRef)(null),T=void 0!==c&&void 0!==d,R=function(e,t){i===Y.Dynamic&&function(e){if(e){if(e&&void 0===window)y(V.Right);else if(O.current){var t=O.current.getBoundingClientRect(),n=t.x,r=n+t.width,i=n>window.innerWidth-r?V.Left:V.Right;y(i)}}else y(null)}(e),E(e?t:null),h(e),T&&void 0!==a?d(e?a:-1):(e!==p&&I===a||e)&&N&&N(e?a:-1)},A=function(){h(!1),E(null)};(0,_.useEffect)((function(){T||I!==a&&p&&A()}),[I]),(0,_.useEffect)((function(){T&&c!==a&&p&&A()}),[c]);var L=(0,_.useCallback)((function(e){p&&O.current&&!O.current.contains(e.target)&&A()}),[p]);return(0,_.useEffect)((function(){return p&&document.addEventListener("click",L),function(){return document.removeEventListener("click",L)}}),[p]),_.createElement("span",Object.assign({className:"NavigationLink-module_navigationLinkWrapper__11IwF"},o&&S===K.Hover&&{onMouseLeave:function(){return R(!1)}},{ref:O}),_.createElement(w.L,Object.assign({className:(0,g.c)("NavigationLink-module_navigationLink__3Vf_4",n,t?"NavigationLink-module_active__2xtqj":void 0),href:s},l,t&&{active:"true"},o&&S!==K.Click&&{onMouseEnter:function(){return R(!0,K.Hover)}}),u),o&&_.createElement(J,{open:p,setOpen:R,index:a,dynamicPosition:k},_.Children.map(o,(function(e,t){return(0,_.cloneElement)(e,{key:t})}))))},ee="HeaderNavigationMenu-module_headerNavigationMenuLinkContent__3zC2j";(0,h.s)(".HeaderNavigationMenu-module_headerNavigationMenu__3G6-N{background-color:var(--color-white);border-bottom:1px solid var(--color-black-20);display:flex;height:64px;width:100%}.HeaderNavigationMenu-module_headerNavigationMenuList__3HIzx{display:flex;flex-wrap:wrap;gap:0 var(--spacing-xs);list-style:none;margin:0;padding:0;width:100%}.HeaderNavigationMenu-module_headerNavigationMenuLinkContainer__2RkuK{margin-left:var(--spacing-xs);margin-right:var(--spacing-xs)}.HeaderNavigationMenu-module_headerNavigationMenuLinkContent__3zC2j{align-items:center;display:flex;height:100%}.HeaderNavigationMenu-module_headerNavigationMenuLinkContentActive__3QtW_{box-shadow:inset 0 -4px 0 0 var(--color-black-90)}.HeaderNavigationMenu-module_headerNavigationMenuLinkContentActive__3QtW_ .HeaderNavigationMenu-module_headerNavigationMenuLink__H_ogS{font-weight:700}.HeaderNavigationMenu-module_headerNavigationMenuLink__H_ogS.HeaderNavigationMenu-module_headerNavigationMenuLink__H_ogS{font-size:var(--fontsize-body-l);padding:var(--spacing-s) var(--spacing-s) var(--spacing-s) 0}");var te=function(e){var t=e.children,n=e.className,r=e.id,i={isSmallScreen:G("m"),isMediumScreen:G("l")};return _.createElement(B.Provider,{value:i},_.createElement("header",{id:r,className:(0,g.c)("Header-module_header__291GF",n)},_.createElement("div",{className:"Header-module_headerBackgroundWrapper__KsFy2"},t)))};te.UniversalBar=function(e){var t=e.ariaLabel,n=e.children,r=e.id,i=e.primaryLinkHref,o=e.primaryLinkText;if((0,_.useContext)(B).isSmallScreen)return null;var s=(0,S.b)(n);return _.createElement("nav",{role:"navigation","aria-label":t,id:r,className:"HeaderUniversalBar-module_headerUniversalBar__1WF8C"},_.createElement("ul",{className:"HeaderUniversalBar-module_headerUniversalBarList__1ci3u"},_.createElement("li",{className:"HeaderUniversalBar-module_universalBarMainLinkContainer__xZGVq"},_.createElement($,{href:i,label:o,className:W})),_.Children.map(s,(function(e,t){return _.isValidElement(e)?_.createElement("li",{key:"secondary-link-"+t,className:"HeaderUniversalBar-module_universalBarSecondaryLinkContainer__3itUq"},(0,_.cloneElement)(e,{className:(0,g.c)(e.props.className,W)})):null}))))},te.NavigationMenu=function(e){var t=e.ariaLabel,n=e.children,r=e.id,i=(0,_.useContext)(B).isMediumScreen,o=(0,_.useState)(-1),s=o[0],a=o[1];if(i)return null;var u=(0,S.b)(n),c={openMainNavIndex:s,setOpenMainNavIndex:a};return _.createElement("nav",{role:"navigation","aria-label":t,id:r,className:"HeaderNavigationMenu-module_headerNavigationMenu__3G6-N"},_.createElement("ul",{className:"HeaderNavigationMenu-module_headerNavigationMenuList__3HIzx"},_.createElement(X.Provider,{value:c},_.Children.map(u,(function(e,t){if(_.isValidElement(e)){var n=e.props.active?(0,g.c)(ee,"HeaderNavigationMenu-module_headerNavigationMenuLinkContentActive__3QtW_"):ee;return _.createElement("li",{key:t,className:"HeaderNavigationMenu-module_headerNavigationMenuLinkContainer__2RkuK"},_.createElement("span",{className:n},(0,_.cloneElement)(e,{className:(0,g.c)(e.props.className,"HeaderNavigationMenu-module_headerNavigationMenuLink__H_ogS"),index:t})))}return null})))))},te.NavigationLink=$;var ne=(0,y.c)((function(e,t){var n;e.exports=(n=n||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==y.a&&y.a.crypto&&(n=y.a.crypto),!n&&"function"==typeof y.b)try{n=x}catch(e){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),o={},s=o.lib={},a=s.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=s.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=s<<24-(r+o)%4*8}else for(var a=0;a<i;a+=4)t[r+a>>>2]=n[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new u.init(t,e)}}),c=o.enc={},d=c.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new u.init(n,t/2)}},l=c.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new u.init(n,t)}},f=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},p=s.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,i=r.words,o=r.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,d=e.min(4*c,o);if(c){for(var l=0;l<c;l+=s)this._doProcessBlock(i,l);n=i.splice(0,c),r.sigBytes-=d}return new u.init(n,d)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=p.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new _.HMAC.init(e,n).finalize(t)}}});var _=o.algo={};return o}(Math),n)})),re=(0,y.c)((function(e,t){var n;e.exports=(n=ne,function(e){var t=n,r=t.lib,i=r.WordArray,o=r.Hasher,s=t.algo,a=[],u=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)t(r)&&(i<8&&(a[i]=n(e.pow(r,.5))),u[i]=n(e.pow(r,1/3)),i++),r++}();var c=[],d=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],d=n[5],l=n[6],f=n[7],p=0;p<64;p++){if(p<16)c[p]=0|e[t+p];else{var _=c[p-15],h=(_<<25|_>>>7)^(_<<14|_>>>18)^_>>>3,g=c[p-2],v=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;c[p]=h+c[p-7]+v+c[p-16]}var m=r&i^r&o^i&o,w=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),S=f+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&d^~a&l)+u[p]+c[p];f=l,l=d,d=a,a=s+S|0,s=o,o=i,i=r,r=S+(w+m)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+d|0,n[6]=n[6]+l|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(d),t.HmacSHA256=o._createHmacHelper(d)}(Math),n.SHA256)})),ie=(0,y.c)((function(e,t){var n;e.exports=(n=ne,function(){var e=n,t=e.lib.WordArray;function r(e,n,r){for(var i=[],o=0,s=0;s<n;s++)if(s%4){var a=r[e.charCodeAt(s-1)]<<s%4*2|r[e.charCodeAt(s)]>>>6-s%4*2;i[o>>>2]|=a<<24-o%4*8,o++}return t.create(i,o)}e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],o=0;o<n;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<n;a++)i.push(r.charAt(s>>>6*(3-a)&63));var u=r.charAt(64);if(u)for(;i.length%4;)i.push(u);return i.join("")},parse:function(e){var t=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<n.length;o++)i[n.charCodeAt(o)]=o}var s=n.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return r(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64)})),oe=(0,y.c)((function(e,t){e.exports=ne.enc.Utf8}));function se(e){this.message=e}se.prototype=new Error,se.prototype.name="InvalidCharacterError";var ae="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new se("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i=0,o=0,s="";r=t.charAt(o++);~r&&(n=i%4?64*n+r:r,i++%4)?s+=String.fromCharCode(255&n>>(-2*i&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return s};function ue(e){this.message=e}function ce(e,t){if("string"!=typeof e)throw new ue("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(ae(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return ae(t)}}(e.split(".")[n]))}catch(e){throw new ue("Invalid token specified: "+e.message)}}ue.prototype=new Error,ue.prototype.name="InvalidTokenError";var de=(0,y.g)(Object.freeze({__proto__:null,default:ce,InvalidTokenError:ue})),le=(0,y.c)((function(e){var t,n=Object.create,r=Object.defineProperty,f=Object.getOwnPropertyDescriptor,_=Object.getOwnPropertyNames,h=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty,v=function(e,t,n,i){if(t&&"object"==typeof t||"function"==typeof t)for(var o,s=function(){var s=o.value;g.call(e,s)||s===n||r(e,s,{get:function(){return t[s]},enumerable:!(i=f(t,s))||i.enumerable})},a=Z(_(t));!(o=a()).done;)s();return e},m=function(e,t,i){return i=null!=e?n(h(e)):{},v(!t&&e&&e.__esModule?i:r(i,"default",{value:e,enumerable:!0}),e)},w={};(function(e,t){for(var n in t)r(e,n,{get:t[n],enumerable:!0})})(w,{AccessTokenEvents:function(){return $},CheckSessionIFrame:function(){return ee},ErrorResponse:function(){return Y},ErrorTimeout:function(){return X},InMemoryWebStorage:function(){return te},Log:function(){return B},Logger:function(){return q},MetadataService:function(){return ae},OidcClient:function(){return me},OidcClientSettingsStore:function(){return ce},SessionMonitor:function(){return we},SigninResponse:function(){return ge},SigninState:function(){return he},SignoutResponse:function(){return ve},State:function(){return _e},User:function(){return Se},UserManager:function(){return Te},UserManagerSettingsStore:function(){return xe},Version:function(){return Re},WebStorageStateStore:function(){return ue}}),e.exports=(t=w,v(r({},"__esModule",{value:!0}),t));var S,E,b,k=m(ne),y=m(re),x=m(ie),j=m(oe),F={debug:function(){},info:function(){},warn:function(){},error:function(){}},B=function(e){return e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e}(B||{});(b=B||(B={})).reset=function(){S=3,E=F},b.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");S=e},b.setLogger=function(e){E=e};var q=function(){function e(e){this._name=e}var t=e.prototype;return t.debug=function(){if(S>=4){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=E).debug.apply(t,[e._format(this._name,this._method)].concat(r))}},t.info=function(){if(S>=3){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=E).info.apply(t,[e._format(this._name,this._method)].concat(r))}},t.warn=function(){if(S>=2){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=E).warn.apply(t,[e._format(this._name,this._method)].concat(r))}},t.error=function(){if(S>=1){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=E).error.apply(t,[e._format(this._name,this._method)].concat(r))}},t.throw=function(e){throw this.error(e),e},t.create=function(e){var t=Object.create(this);return t._method=e,t.debug("begin"),t},e.createStatic=function(t,n){var r=new e(t+"."+n);return r.debug("begin"),r},e._format=function(e,t){var n="["+e+"]";return t?n+" "+t+":":n},e.debug=function(t){if(S>=4){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=E).debug.apply(n,[e._format(t)].concat(i))}},e.info=function(t){if(S>=3){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=E).info.apply(n,[e._format(t)].concat(i))}},e.warn=function(t){if(S>=2){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=E).warn.apply(n,[e._format(t)].concat(i))}},e.error=function(t){if(S>=1){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=E).error.apply(n,[e._format(t)].concat(i))}},e}();B.reset();var G=function(){function e(){}return e._randomWord=function(){return k.default.lib.WordArray.random(1).words[0]},e.generateUUIDv4=function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){return(+t^e._randomWord()&15>>+t/4).toString(16)})).replace(/-/g,"")},e.generateCodeVerifier=function(){return e.generateUUIDv4()+e.generateUUIDv4()+e.generateUUIDv4()},e.generateCodeChallenge=function(e){try{var t=(0,y.default)(e);return x.default.stringify(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(e){throw q.error("CryptoUtils.generateCodeChallenge",e),e}},e.generateBasicAuth=function(e,t){var n=j.default.parse([e,t].join(":"));return x.default.stringify(n)},e}(),W=function(){function e(e){this._name=e,this._logger=new q("Event('"+this._name+"')"),this._callbacks=[]}var t=e.prototype;return t.addHandler=function(e){var t=this;return this._callbacks.push(e),function(){return t.removeHandler(e)}},t.removeHandler=function(e){var t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)},t.raise=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=this._logger).debug.apply(e,["raise:"].concat(n));for(var i,o=Z(this._callbacks);!(i=o()).done;){i.value.apply(void 0,n)}},e}(),K=m(de),V=function(){function e(){}return e.decode=function(e){try{return(0,K.default)(e)}catch(e){throw q.error("JwtUtils.decode",e),e}},e}(),z=function(){function e(){}return e.center=function(e){var t,n=Object.assign({},((0,l.Z)(e),e));return null==n.width&&(n.width=null!=(t=[800,720,600,480].find((function(e){return e<=window.outerWidth/1.618})))?t:360),null!=n.left||(n.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-n.width)/2))),null!=n.height&&(null!=n.top||(n.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-n.height)/2)))),n},e.serialize=function(e){return Object.entries(e).filter((function(e){return null!=e[1]})).map((function(e){var t=e[0],n=e[1];return t+"="+("boolean"!=typeof n?n:n?"yes":"no")})).join(",")},e}(),Q=function(e){function t(){var n;return(n=e.apply(this,arguments)||this)._logger=new q("Timer('"+n._name+"')"),n._timerHandle=null,n._expiration=0,n._callback=function(){var r=n._expiration-t.getEpochTime();n._logger.debug("timer completes in",r),n._expiration<=t.getEpochTime()&&(n.cancel(),e.prototype.raise.call((0,c.Z)(n)))},n}(0,d.Z)(t,e),t.getEpochTime=function(){return Math.floor(Date.now()/1e3)};var n=t.prototype;return n.init=function(e){var n=this._logger.create("init");e=Math.max(Math.floor(e),1);var r=t.getEpochTime()+e;if(this.expiration===r&&this._timerHandle)n.debug("skipping since already initialized for expiration at",this.expiration);else{this.cancel(),n.debug("using duration",e),this._expiration=r;var i=Math.min(e,5);this._timerHandle=setInterval(this._callback,1e3*i)}},n.cancel=function(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)},(0,u.Z)(t,[{key:"expiration",get:function(){return this._expiration}}]),t}(W),J=function(){function e(){}return e.readParams=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"query";if(!e)throw new TypeError("Invalid URL");var n=new URL(e,window.location.origin)["fragment"===t?"hash":"search"];return new URLSearchParams(n.slice(1))},e}(),Y=function(e){function t(t,n){var r,i,o,s;if((r=e.call(this,t.error_description||t.error||"")||this).form=n,r.name="ErrorResponse",!t.error)throw q.error("ErrorResponse","No error passed"),new Error("No error passed");return r.error=t.error,r.error_description=null!=(i=t.error_description)?i:null,r.error_uri=null!=(o=t.error_uri)?o:null,r.state=t.userState,r.session_state=null!=(s=t.session_state)?s:null,(0,c.Z)(r)}return(0,d.Z)(t,e),t}((0,a.Z)(Error)),X=function(e){function t(t){var n;return(n=e.call(this,t)||this).name="ErrorTimeout",n}return(0,d.Z)(t,e),t}((0,a.Z)(Error)),$=function(){function e(e){this._logger=new q("AccessTokenEvents"),this._expiringTimer=new Q("Access token expiring"),this._expiredTimer=new Q("Access token expired"),this._expiringNotificationTimeInSeconds=e.expiringNotificationTimeInSeconds}var t=e.prototype;return t.load=function(e){var t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){var n=e.expires_in;if(t.debug("access token present, remaining duration:",n),n>0){var r=n-this._expiringNotificationTimeInSeconds;r<=0&&(r=1),t.debug("registering expiring timer, raising in",r,"seconds"),this._expiringTimer.init(r)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();var i=n+1;t.debug("registering expired timer, raising in",i,"seconds"),this._expiredTimer.init(i)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()},t.unload=function(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()},t.addAccessTokenExpiring=function(e){return this._expiringTimer.addHandler(e)},t.removeAccessTokenExpiring=function(e){this._expiringTimer.removeHandler(e)},t.addAccessTokenExpired=function(e){return this._expiredTimer.addHandler(e)},t.removeAccessTokenExpired=function(e){this._expiredTimer.removeHandler(e)},e}(),ee=function(){function e(e,t,n,r,i){var o=this;this._callback=e,this._client_id=t,this._intervalInSeconds=r,this._stopOnError=i,this._logger=new q("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=function(e){e.origin===o._frame_origin&&e.source===o._frame.contentWindow&&("error"===e.data?(o._logger.error("error message from check session op iframe"),o._stopOnError&&o.stop()):"changed"===e.data?(o._logger.debug("changed message from check session op iframe"),o.stop(),o._callback()):o._logger.debug(e.data+" message from check session op iframe"))};var s=new URL(n);this._frame_origin=s.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=s.href}var t=e.prototype;return t.load=function(){var e=this;return new Promise((function(t){e._frame.onload=function(){t()},window.document.body.appendChild(e._frame),window.addEventListener("message",e._message,!1)}))},t.start=function(e){var t=this;if(this._session_state!==e){this._logger.create("start"),this.stop(),this._session_state=e;var n=function(){t._frame.contentWindow&&t._session_state&&t._frame.contentWindow.postMessage(t._client_id+" "+t._session_state,t._frame_origin)};n(),this._timer=setInterval(n,1e3*this._intervalInSeconds)}},t.stop=function(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)},e}(),te=function(){function e(){this._logger=new q("InMemoryWebStorage"),this._data={}}var t=e.prototype;return t.clear=function(){this._logger.create("clear"),this._data={}},t.getItem=function(e){return this._logger.create("getItem('"+e+"')"),this._data[e]},t.setItem=function(e,t){this._logger.create("setItem('"+e+"')"),this._data[e]=t},t.removeItem=function(e){this._logger.create("removeItem('"+e+"')"),delete this._data[e]},t.key=function(e){return Object.getOwnPropertyNames(this._data)[e]},(0,u.Z)(e,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),e}(),se=function(){function e(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._jwtHandler=n,this._logger=new q("JsonService"),this._contentTypes=[],(e=this._contentTypes).push.apply(e,(0,s.Z)(t).concat(["application/json"])),n&&this._contentTypes.push("application/jwt")}var t=e.prototype;return t.fetchWithTimeout=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,o,s,a,u=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=u.length>1&&void 0!==u[1]?u[1]:{}).timeoutInSeconds,o=(0,i.Z)(n,I),r){e.next=6;break}return e.next=5,fetch(t,o);case 5:case 10:return e.abrupt("return",e.sent);case 6:return s=new AbortController,a=setTimeout((function(){return s.abort()}),1e3*r),e.prev=7,e.next=10,fetch(t,H(H({},n),{},{signal:s.signal}));case 13:if(e.prev=13,e.t0=e.catch(7),!(e.t0 instanceof DOMException&&"AbortError"===e.t0.name)){e.next=17;break}throw new X("Network timed out");case 17:throw e.t0;case 18:return e.prev=18,clearTimeout(a),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[7,13,18,21]])})));return function(t){return e.apply(this,arguments)}}(),t.getJson=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o,s,a,u,c,d=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=d.length>1&&void 0!==d[1]?d[1]:{}).token,i=n.credentials,o=this._logger.create("getJson"),s={Accept:this._contentTypes.join(", ")},r&&(o.debug("token passed, setting Authorization header"),s.Authorization="Bearer "+r),e.prev=3,o.debug("url:",t),e.next=7,this.fetchWithTimeout(t,{method:"GET",headers:s,credentials:i});case 7:a=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(3),o.error("Network Error"),e.t0;case 13:if(o.debug("HTTP response received, status",a.status),(u=a.headers.get("Content-Type"))&&!this._contentTypes.find((function(e){return u.startsWith(e)}))&&o.throw(new Error("Invalid response Content-Type: "+(null!=u?u:"undefined")+", from URL: "+t)),!(a.ok&&this._jwtHandler&&(null==u?void 0:u.startsWith("application/jwt")))){e.next=23;break}return e.t1=this,e.next=19,a.text();case 19:return e.t2=e.sent,e.next=22,e.t1._jwtHandler.call(e.t1,e.t2);case 22:return e.abrupt("return",e.sent);case 23:return e.prev=23,e.next=26,a.json();case 26:c=e.sent,e.next=34;break;case 29:if(e.prev=29,e.t3=e.catch(23),o.error("Error parsing JSON response",e.t3),!a.ok){e.next=33;break}throw e.t3;case 33:throw new Error(a.statusText+" ("+a.status+")");case 34:if(a.ok){e.next=38;break}if(o.error("Error from server:",c),!c.error){e.next=37;break}throw new Y(c);case 37:throw new Error(a.statusText+" ("+a.status+"): "+JSON.stringify(c));case 38:return e.abrupt("return",c);case 39:case"end":return e.stop()}}),e,this,[[3,10],[23,29]])})));return function(t){return e.apply(this,arguments)}}(),t.postForm=function(){var e=(0,o.Z)(p().mark((function e(t,n){var r,i,o,s,a,u,c,d,l,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.body,i=n.basicAuth,o=n.timeoutInSeconds,s=n.initCredentials,a=this._logger.create("postForm"),u={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"},void 0!==i&&(u.Authorization="Basic "+i),e.prev=3,a.debug("url:",t),e.next=7,this.fetchWithTimeout(t,{method:"POST",headers:u,body:r,timeoutInSeconds:o,credentials:s});case 7:c=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(3),a.error("Network error"),e.t0;case 13:if(a.debug("HTTP response received, status",c.status),!(d=c.headers.get("Content-Type"))||this._contentTypes.find((function(e){return d.startsWith(e)}))){e.next=17;break}throw new Error("Invalid response Content-Type: "+(null!=d?d:"undefined")+", from URL: "+t);case 17:return e.next=19,c.text();case 19:if(l=e.sent,f={},!l){e.next=31;break}e.prev=22,f=JSON.parse(l),e.next=31;break;case 26:if(e.prev=26,e.t1=e.catch(22),a.error("Error parsing JSON response",e.t1),!c.ok){e.next=30;break}throw e.t1;case 30:throw new Error(c.statusText+" ("+c.status+")");case 31:if(c.ok){e.next=35;break}if(a.error("Error from server:",f),!f.error){e.next=34;break}throw new Y(f,r);case 34:throw new Error(c.statusText+" ("+c.status+"): "+JSON.stringify(f));case 35:return e.abrupt("return",f);case 36:case"end":return e.stop()}}),e,this,[[3,10],[22,26]])})));return function(t,n){return e.apply(this,arguments)}}(),e}(),ae=function(){function e(e){this._settings=e,this._logger=new q("MetadataService"),this._jsonService=new se(["application/jwk-set+json"]),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}var t=e.prototype;return t.resetSigningKeys=function(){this._signingKeys=null},t.getMetadata=function(){var e=(0,o.Z)(p().mark((function e(){var t,n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._logger.create("getMetadata"),!this._metadata){e.next=3;break}return e.abrupt("return",(t.debug("using cached values"),this._metadata));case 3:if(this._metadataUrl){e.next=5;break}throw t.throw(new Error("No authority or metadataUrl configured on settings")),null;case 5:return t.debug("getting metadata from",this._metadataUrl),e.next=8,this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});case 8:return n=e.sent,e.abrupt("return",(t.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,n),this._metadata));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getIssuer=function(){return this._getMetadataProperty("issuer")},t.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},t.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},t.getTokenEndpoint=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",e)},t.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},t.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},t.getRevocationEndpoint=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("revocation_endpoint",e)},t.getKeysEndpoint=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("jwks_uri",e)},t._getMetadataProperty=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]&&o[1],r=this._logger.create("_getMetadataProperty('"+t+"')"),e.next=4,this.getMetadata();case 4:if(i=e.sent,r.debug("resolved"),void 0!==i[t]){e.next=9;break}if(!0!==n){e.next=8;break}return e.abrupt("return",void r.warn("Metadata does not contain optional property"));case 8:r.throw(new Error("Metadata does not contain property "+t));case 9:return e.abrupt("return",i[t]);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getSigningKeys=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._logger.create("getSigningKeys"),!this._signingKeys){e.next=3;break}return e.abrupt("return",(t.debug("returning signingKeys from cache"),this._signingKeys));case 3:return e.next=5,this.getKeysEndpoint(!1);case 5:return n=e.sent,t.debug("got jwks_uri",n),e.next=9,this._jsonService.getJson(n);case 9:if(r=e.sent,t.debug("got key set",r),Array.isArray(r.keys)){e.next=12;break}throw t.throw(new Error("Missing keys on keyset")),null;case 12:return e.abrupt("return",(this._signingKeys=r.keys,this._signingKeys));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),ue=function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.prefix,n=void 0===t?"oidc.":t,r=e.store,i=void 0===r?localStorage:r;this._logger=new q("WebStorageStateStore"),this._store=i,this._prefix=n}var t=e.prototype;return t.set=function(){var e=(0,o.Z)(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("set('"+t+"')"),t=this._prefix+t,e.next=4,this._store.setItem(t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.get=function(){var e=(0,o.Z)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("get('"+t+"')"),t=this._prefix+t,e.next=3,this._store.getItem(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.remove=function(){var e=(0,o.Z)(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("remove('"+t+"')"),t=this._prefix+t,e.next=3,this._store.getItem(t);case 3:return n=e.sent,e.next=6,this._store.removeItem(t);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getAllKeys=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("getAllKeys"),e.next=3,this._store.length;case 3:t=e.sent,n=[],r=0;case 6:if(!(r<t)){e.next=14;break}return e.next=9,this._store.key(r);case 9:(i=e.sent)&&0===i.indexOf(this._prefix)&&n.push(i.substr(this._prefix.length));case 11:r++,e.next=6;break;case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),ce=function(e){var t=e.authority,n=e.metadataUrl,r=e.metadata,i=e.signingKeys,o=e.metadataSeed,s=e.client_id,a=e.client_secret,u=e.response_type,c=void 0===u?"code":u,d=e.scope,l=void 0===d?"openid":d,f=e.redirect_uri,p=e.post_logout_redirect_uri,_=e.client_authentication,h=void 0===_?"client_secret_post":_,g=e.prompt,v=e.display,m=e.max_age,w=e.ui_locales,S=e.acr_values,E=e.resource,b=e.response_mode,k=void 0===b?"query":b,y=e.filterProtocolClaims,x=void 0===y||y,I=e.loadUserInfo,N=void 0!==I&&I,O=e.staleStateAgeInSeconds,T=void 0===O?900:O,R=e.clockSkewInSeconds,A=void 0===R?300:R,L=e.userInfoJwtIssuer,P=void 0===L?"OP":L,C=e.mergeClaims,U=void 0!==C&&C,D=e.disablePKCE,M=void 0!==D&&D,j=e.stateStore,H=e.refreshTokenCredentials,Z=e.revokeTokenAdditionalContentTypes,F=e.fetchRequestCredentials,B=e.refreshTokenAllowedScope,q=e.extraQueryParams,G=void 0===q?{}:q,W=e.extraTokenParams,K=void 0===W?{}:W;if(this.authority=t,n?this.metadataUrl=n:(this.metadataUrl=t,t&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=o,this.signingKeys=i,this.client_id=s,this.client_secret=a,this.response_type=c,this.scope=l,this.redirect_uri=f,this.post_logout_redirect_uri=p,this.client_authentication=h,this.prompt=g,this.display=v,this.max_age=m,this.ui_locales=w,this.acr_values=S,this.resource=E,this.response_mode=k,this.filterProtocolClaims=null==x||x,this.loadUserInfo=!!N,this.staleStateAgeInSeconds=T,this.clockSkewInSeconds=A,this.userInfoJwtIssuer=P,this.mergeClaims=!!U,this.disablePKCE=!!M,this.revokeTokenAdditionalContentTypes=Z,F&&H&&console.warn("Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used."),this.fetchRequestCredentials=F||H||"same-origin",j)this.stateStore=j;else{var V="undefined"!=typeof window?window.localStorage:new te;this.stateStore=new ue({store:V})}this.refreshTokenAllowedScope=B,this.extraQueryParams=G,this.extraTokenParams=K},le=function(){function e(e,t){this._settings=e,this._metadataService=t,this._logger=new q("TokenClient"),this._jsonService=new se(this._settings.revokeTokenAdditionalContentTypes)}var t=e.prototype;return t.exchangeCode=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,o,s,a,u,c,d,l,f,_,h,g,v,m,w,S,E,b;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.grant_type,r=void 0===n?"authorization_code":n,o=t.redirect_uri,s=void 0===o?this._settings.redirect_uri:o,a=t.client_id,u=void 0===a?this._settings.client_id:a,c=t.client_secret,d=void 0===c?this._settings.client_secret:c,l=(0,i.Z)(t,N),f=this._logger.create("exchangeCode"),u||f.throw(new Error("A client_id is required")),s||f.throw(new Error("A redirect_uri is required")),l.code||f.throw(new Error("A code is required")),_=new URLSearchParams({grant_type:r,redirect_uri:s}),h=0,g=Object.entries(l);h<g.length;h++)v=g[h],m=v[0],null!=(w=v[1])&&_.set(m,w);e.t0=this._settings.client_authentication,e.next="client_secret_basic"===e.t0?8:"client_secret_post"===e.t0?12:13;break;case 8:if(d){e.next=10;break}throw f.throw(new Error("A client_secret is required")),null;case 10:return S=G.generateBasicAuth(u,d),e.abrupt("break",13);case 12:_.append("client_id",u),d&&_.append("client_secret",d);case 13:return e.next=15,this._metadataService.getTokenEndpoint(!1);case 15:return E=e.sent,f.debug("got token endpoint"),e.next=19,this._jsonService.postForm(E,{body:_,basicAuth:S,initCredentials:this._settings.fetchRequestCredentials});case 19:return b=e.sent,e.abrupt("return",(f.debug("got response"),b));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.exchangeCredentials=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,o,s,a,u,c,d,l,f,_,h,g,v,m,w,S,E,b;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.grant_type,r=void 0===n?"password":n,o=t.client_id,s=void 0===o?this._settings.client_id:o,a=t.client_secret,u=void 0===a?this._settings.client_secret:a,c=t.scope,d=void 0===c?this._settings.scope:c,l=(0,i.Z)(t,O),f=this._logger.create("exchangeCredentials"),s||f.throw(new Error("A client_id is required")),_=new URLSearchParams({grant_type:r,scope:d}),h=0,g=Object.entries(l);h<g.length;h++)v=g[h],m=v[0],null!=(w=v[1])&&_.set(m,w);e.t0=this._settings.client_authentication,e.next="client_secret_basic"===e.t0?8:"client_secret_post"===e.t0?12:13;break;case 8:if(u){e.next=10;break}throw f.throw(new Error("A client_secret is required")),null;case 10:return S=G.generateBasicAuth(s,u),e.abrupt("break",13);case 12:_.append("client_id",s),u&&_.append("client_secret",u);case 13:return e.next=15,this._metadataService.getTokenEndpoint(!1);case 15:return E=e.sent,f.debug("got token endpoint"),e.next=19,this._jsonService.postForm(E,{body:_,basicAuth:S,initCredentials:this._settings.fetchRequestCredentials});case 19:return b=e.sent,e.abrupt("return",(f.debug("got response"),b));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.exchangeRefreshToken=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,o,s,a,u,c,d,l,f,_,h,g,v,m,w,S,E;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.grant_type,r=void 0===n?"refresh_token":n,o=t.client_id,s=void 0===o?this._settings.client_id:o,a=t.client_secret,u=void 0===a?this._settings.client_secret:a,c=t.timeoutInSeconds,d=(0,i.Z)(t,T),l=this._logger.create("exchangeRefreshToken"),s||l.throw(new Error("A client_id is required")),d.refresh_token||l.throw(new Error("A refresh_token is required")),f=new URLSearchParams({grant_type:r}),_=0,h=Object.entries(d);_<h.length;_++)g=h[_],v=g[0],null!=(m=g[1])&&f.set(v,m);e.t0=this._settings.client_authentication,e.next="client_secret_basic"===e.t0?8:"client_secret_post"===e.t0?12:13;break;case 8:if(u){e.next=10;break}throw l.throw(new Error("A client_secret is required")),null;case 10:return w=G.generateBasicAuth(s,u),e.abrupt("break",13);case 12:f.append("client_id",s),u&&f.append("client_secret",u);case 13:return e.next=15,this._metadataService.getTokenEndpoint(!1);case 15:return S=e.sent,l.debug("got token endpoint"),e.next=19,this._jsonService.postForm(S,{body:f,basicAuth:w,timeoutInSeconds:c,initCredentials:this._settings.fetchRequestCredentials});case 19:return E=e.sent,e.abrupt("return",(l.debug("got response"),E));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.revoke=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o,s,a,u,c,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("revoke"),t.token||r.throw(new Error("A token is required")),e.next=4,this._metadataService.getRevocationEndpoint(!1);case 4:for(i=e.sent,r.debug("got revocation endpoint, revoking "+(null!=(n=t.token_type_hint)?n:"default token type")),o=new URLSearchParams,s=0,a=Object.entries(t);s<a.length;s++)u=a[s],c=u[0],null!=(d=u[1])&&o.set(c,d);return o.set("client_id",this._settings.client_id),this._settings.client_secret&&o.set("client_secret",this._settings.client_secret),e.next=12,this._jsonService.postForm(i,{body:o});case 12:r.debug("got response");case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),fe=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],pe=["sub","iss","aud","exp","iat"],_e=function(){function e(e){this.id=e.id||G.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=Q.getEpochTime(),this.request_type=e.request_type}return e.prototype.toStorageString=function(){return new q("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},e.fromStorageString=function(t){return q.createStatic("State","fromStorageString"),new e(JSON.parse(t))},e.clearStaleState=function(){var t=(0,o.Z)(p().mark((function t(n,r){var i,o,s,a,u,c,d,l;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=q.createStatic("State","clearStaleState"),o=Q.getEpochTime()-r,t.next=4,n.getAllKeys();case 4:s=t.sent,i.debug("got keys",s),a=0;case 7:if(!(a<s.length)){t.next=18;break}return u=s[a],t.next=11,n.get(u);case 11:if(c=t.sent,d=!1,c)try{l=e.fromStorageString(c),i.debug("got item from key:",u,l.created),l.created<=o&&(d=!0)}catch(n){i.error("Error parsing state for key:",u,n),d=!0}else i.debug("no item in storage for key:",u),d=!0;d&&(i.debug("removed item for key:",u),n.remove(u));case 15:a++,t.next=7;break;case 18:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}(),he=function(e){function t(t){var n;return n=e.call(this,t)||this,!0===t.code_verifier?n.code_verifier=G.generateCodeVerifier():t.code_verifier&&(n.code_verifier=t.code_verifier),n.code_verifier&&(n.code_challenge=G.generateCodeChallenge(n.code_verifier)),n.authority=t.authority,n.client_id=t.client_id,n.redirect_uri=t.redirect_uri,n.scope=t.scope,n.client_secret=t.client_secret,n.extraTokenParams=t.extraTokenParams,n.response_mode=t.response_mode,n.skipUserInfo=t.skipUserInfo,n}return(0,d.Z)(t,e),t.prototype.toStorageString=function(){return new q("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})},t.fromStorageString=function(e){return q.createStatic("SigninState","fromStorageString"),new t(JSON.parse(e))},t}(_e),ge=function(){function e(e){this.access_token="",this.token_type="",this.profile={},this.state=e.get("state"),this.session_state=e.get("session_state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri"),this.code=e.get("code")}return(0,u.Z)(e,[{key:"expires_in",get:function(){if(void 0!==this.expires_at)return this.expires_at-Q.getEpochTime()},set:function(e){"string"==typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+Q.getEpochTime())}},{key:"isOpenId",get:function(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}}]),e}(),ve=function(e){this.state=e.get("state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri")},me=function(){function e(e){this._logger=new q("OidcClient"),this.settings=new ce(e),this.metadataService=new ae(this.settings),this._validator=new(function(){function e(e,t){this._settings=e,this._metadataService=t,this._logger=new q("ResponseValidator"),this._userInfoService=new(function(){function e(e,t){var n=this;this._settings=e,this._metadataService=t,this._logger=new q("UserInfoService"),this._getClaimsFromJwt=function(){var e=(0,o.Z)(p().mark((function e(t){var r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n._logger.create("_getClaimsFromJwt"),e.prev=1,i=V.decode(t),e.abrupt("return",(r.debug("JWT decoding successful"),i));case 6:throw e.prev=6,e.t0=e.catch(1),r.error("Error parsing JWT response"),e.t0;case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),this._jsonService=new se(void 0,this._getClaimsFromJwt)}return e.prototype.getClaims=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("getClaims"),t||this._logger.throw(new Error("No token passed")),e.next=4,this._metadataService.getUserInfoEndpoint();case 4:return r=e.sent,n.debug("got userinfo url",r),e.next=8,this._jsonService.getJson(r,{token:t,credentials:this._settings.fetchRequestCredentials});case 8:return i=e.sent,e.abrupt("return",(n.debug("got claims",i),i));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}())(this._settings,this._metadataService),this._tokenClient=new le(this._settings,this._metadataService)}var t=e.prototype;return t.validateSigninResponse=function(){var e=(0,o.Z)(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("validateSigninResponse"),this._processSigninState(t,n),r.debug("state processed"),e.next=5,this._processCode(t,n);case 5:return r.debug("code processed"),t.isOpenId&&this._validateIdTokenAttributes(t),r.debug("tokens validated"),e.next=10,this._processClaims(t,null==n?void 0:n.skipUserInfo,t.isOpenId);case 10:r.debug("claims processed");case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.validateCredentialsResponse=function(){var e=(0,o.Z)(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("validateCredentialsResponse"),t.isOpenId&&this._validateIdTokenAttributes(t),r.debug("tokens validated"),e.next=5,this._processClaims(t,n,t.isOpenId);case 5:r.debug("claims processed");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.validateRefreshResponse=function(){var e=(0,o.Z)(p().mark((function e(t,n){var r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("validateRefreshResponse"),t.userState=n.data,null!=t.session_state||(t.session_state=n.session_state),null!=t.scope||(t.scope=n.scope),t.isOpenId&&t.id_token&&(this._validateIdTokenAttributes(t,n.id_token),r.debug("ID Token validated")),t.id_token||(t.id_token=n.id_token,t.profile=n.profile),i=t.isOpenId&&!!t.id_token,e.next=5,this._processClaims(t,!1,i);case 5:r.debug("claims processed");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.validateSignoutResponse=function(e,t){var n=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&n.throw(new Error("State does not match")),n.debug("state validated"),e.userState=t.data,e.error)throw n.warn("Response was error",e.error),new Y(e)},t._processSigninState=function(e,t){var n=this._logger.create("_processSigninState");if(t.id!==e.state&&n.throw(new Error("State does not match")),t.client_id||n.throw(new Error("No client_id on state")),t.authority||n.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&n.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&n.throw(new Error("client_id mismatch on settings vs. signin state")),n.debug("state validated"),e.userState=t.data,null!=e.scope||(e.scope=t.scope),e.error)throw n.warn("Response was error",e.error),new Y(e);t.code_verifier&&!e.code&&n.throw(new Error("Expected code in response"))},t._processClaims=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o,s=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]&&s[1],r=!(s.length>2&&void 0!==s[2])||s[2],i=this._logger.create("_processClaims"),t.profile=this._filterProtocolClaims(t.profile),!n&&this._settings.loadUserInfo&&t.access_token){e.next=4;break}return e.abrupt("return",void i.debug("not loading user info"));case 4:return i.debug("loading user info"),e.next=7,this._userInfoService.getClaims(t.access_token);case 7:o=e.sent,i.debug("user info claims received from user info endpoint"),r&&o.sub!==t.profile.sub&&i.throw(new Error("subject from UserInfo response does not match subject in ID Token")),t.profile=this._mergeClaims(t.profile,this._filterProtocolClaims(o)),i.debug("user info claims received, updated profile:",t.profile);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._mergeClaims=function(e,t){for(var n=H({},e),r=0,i=Object.entries(t);r<i.length;r++)for(var o,s=i[r],a=s[0],u=s[1],c=Z(Array.isArray(u)?u:[u]);!(o=c()).done;){var d=o.value,l=n[a];l?Array.isArray(l)?l.includes(d)||l.push(d):n[a]!==d&&("object"==typeof d&&this._settings.mergeClaims?n[a]=this._mergeClaims(l,d):n[a]=[l,d]):n[a]=d}return n},t._filterProtocolClaims=function(e){var t=H({},e);if(this._settings.filterProtocolClaims)for(var n,r=Z(Array.isArray(this._settings.filterProtocolClaims)?this._settings.filterProtocolClaims:fe);!(n=r()).done;){var i=n.value;pe.includes(i)||delete t[i]}return t},t._processCode=function(){var e=(0,o.Z)(p().mark((function e(t,n){var r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._logger.create("_processCode"),!t.code){e.next=9;break}return r.debug("Validating code"),e.next=5,this._tokenClient.exchangeCode(H({client_id:n.client_id,client_secret:n.client_secret,code:t.code,redirect_uri:n.redirect_uri,code_verifier:n.code_verifier},n.extraTokenParams));case 5:i=e.sent,Object.assign(t,i),e.next=10;break;case 9:r.debug("No code to process");case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t._validateIdTokenAttributes=function(e,t){var n,r=this._logger.create("_validateIdTokenAttributes");r.debug("decoding ID Token JWT");var i=V.decode(null!=(n=e.id_token)?n:"");if(i.sub||r.throw(new Error("ID Token is missing a subject claim")),t){var o=V.decode(t);o.sub!==i.sub&&r.throw(new Error("sub in id_token does not match current sub")),o.auth_time&&o.auth_time!==i.auth_time&&r.throw(new Error("auth_time in id_token does not match original auth_time")),o.azp&&o.azp!==i.azp&&r.throw(new Error("azp in id_token does not match original azp")),!o.azp&&i.azp&&r.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=i},e}())(this.settings,this.metadataService),this._tokenClient=new le(this.settings,this.metadataService)}var t=e.prototype;return t.createSigninRequest=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,o,s,a,u,c,d,l,f,_,h,g,v,m,w,S,E,b,k,y,x,I,N,O,T,A,L,P,C,U,D,M,j,Z,F;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.state,r=t.request,o=t.request_uri,s=t.request_type,a=t.id_token_hint,u=t.login_hint,c=t.skipUserInfo,d=t.nonce,l=t.response_type,f=void 0===l?this.settings.response_type:l,_=t.scope,h=void 0===_?this.settings.scope:_,g=t.redirect_uri,v=void 0===g?this.settings.redirect_uri:g,m=t.prompt,w=void 0===m?this.settings.prompt:m,S=t.display,E=void 0===S?this.settings.display:S,b=t.max_age,k=void 0===b?this.settings.max_age:b,y=t.ui_locales,x=void 0===y?this.settings.ui_locales:y,I=t.acr_values,N=void 0===I?this.settings.acr_values:I,O=t.resource,T=void 0===O?this.settings.resource:O,A=t.response_mode,L=void 0===A?this.settings.response_mode:A,P=t.extraQueryParams,C=void 0===P?this.settings.extraQueryParams:P,U=t.extraTokenParams,D=void 0===U?this.settings.extraTokenParams:U,M=this._logger.create("createSigninRequest"),"code"===f){e.next=4;break}throw new Error("Only the Authorization Code flow (with PKCE) is supported");case 4:return e.next=6,this.metadataService.getAuthorizationEndpoint();case 6:return j=e.sent,M.debug("Received authorization endpoint",j),Z=new(function(){return function(e){var t=e.url,n=e.authority,r=e.client_id,o=e.redirect_uri,s=e.response_type,a=e.scope,u=e.state_data,c=e.response_mode,d=e.request_type,l=e.client_secret,f=e.nonce,p=e.resource,_=e.skipUserInfo,h=e.extraQueryParams,g=e.extraTokenParams,v=e.disablePKCE,m=(0,i.Z)(e,R);if(this._logger=new q("SigninRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");if(!r)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!o)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!s)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!a)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!n)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new he({data:u,request_type:d,code_verifier:!v,client_id:r,authority:n,redirect_uri:o,response_mode:c,client_secret:l,scope:a,extraTokenParams:g,skipUserInfo:_});var w=new URL(t);w.searchParams.append("client_id",r),w.searchParams.append("redirect_uri",o),w.searchParams.append("response_type",s),w.searchParams.append("scope",a),f&&w.searchParams.append("nonce",f),w.searchParams.append("state",this.state.id),this.state.code_challenge&&(w.searchParams.append("code_challenge",this.state.code_challenge),w.searchParams.append("code_challenge_method","S256")),p&&(Array.isArray(p)?p:[p]).forEach((function(e){return w.searchParams.append("resource",e)}));for(var S=0,E=Object.entries(H(H({response_mode:c},m),h));S<E.length;S++){var b=E[S],k=b[0],y=b[1];null!=y&&w.searchParams.append(k,y.toString())}this.url=w.href}}())({url:j,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:v,response_type:f,scope:h,state_data:n,prompt:w,display:E,max_age:k,ui_locales:x,id_token_hint:a,login_hint:u,acr_values:N,resource:T,request:r,request_uri:o,extraQueryParams:C,extraTokenParams:D,request_type:s,response_mode:L,client_secret:this.settings.client_secret,skipUserInfo:c,nonce:d,disablePKCE:this.settings.disablePKCE}),e.next=11,this.clearStaleState();case 11:return F=Z.state,e.next=14,this.settings.stateStore.set(F.id,F.toStorageString());case 14:return e.abrupt("return",Z);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.readSigninResponseState=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o,s=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]&&s[1],r=this._logger.create("readSigninResponseState"),(i=new ge(J.readParams(t,this.settings.response_mode))).state){e.next=4;break}throw r.throw(new Error("No state in response")),null;case 4:return e.next=6,this.settings.stateStore[n?"remove":"get"](i.state);case 6:if(o=e.sent){e.next=9;break}throw r.throw(new Error("No matching state found in storage")),null;case 9:return e.abrupt("return",{state:he.fromStorageString(o),response:i});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.processSigninResponse=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("processSigninResponse"),e.next=3,this.readSigninResponseState(t,!0);case 3:return r=e.sent,i=r.state,o=r.response,n.debug("received state from storage; validating response"),e.next=9,this._validator.validateSigninResponse(o,i);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.processResourceOwnerPasswordCredentials=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o,s,a,u,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,i=t.skipUserInfo,o=void 0!==i&&i,s=t.extraTokenParams,a=void 0===s?{}:s,e.next=3,this._tokenClient.exchangeCredentials(H({username:n,password:r},a));case 3:return u=e.sent,c=new ge(new URLSearchParams),Object.assign(c,u),e.next=8,this._validator.validateCredentialsResponse(c,o);case 8:return e.abrupt("return",c);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.useRefreshToken=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o,s,a,u,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,r=t.timeoutInSeconds,o=this._logger.create("useRefreshToken"),void 0===this.settings.refreshTokenAllowedScope?s=n.scope:(a=this.settings.refreshTokenAllowedScope.split(" "),s=((null==(i=n.scope)?void 0:i.split(" "))||[]).filter((function(e){return a.includes(e)})).join(" ")),e.next=5,this._tokenClient.exchangeRefreshToken({refresh_token:n.refresh_token,scope:s,timeoutInSeconds:r});case 5:return u=e.sent,c=new ge(new URLSearchParams),Object.assign(c,u),o.debug("validating response",c),e.next=11,this._validator.validateRefreshResponse(c,H(H({},n),{},{scope:s}));case 11:return e.abrupt("return",c);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.createSignoutRequest=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,i,o,s,a,u,c,d,l,f,_=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=_.length>0&&void 0!==_[0]?_[0]:{}).state,r=t.id_token_hint,i=t.request_type,o=t.post_logout_redirect_uri,s=void 0===o?this.settings.post_logout_redirect_uri:o,a=t.extraQueryParams,u=void 0===a?this.settings.extraQueryParams:a,c=this._logger.create("createSignoutRequest"),e.next=4,this.metadataService.getEndSessionEndpoint();case 4:if(d=e.sent){e.next=7;break}throw c.throw(new Error("No end session endpoint")),null;case 7:return c.debug("Received end session endpoint",d),l=new(function(){return function(e){var t=e.url,n=e.state_data,r=e.id_token_hint,i=e.post_logout_redirect_uri,o=e.extraQueryParams,s=e.request_type;if(this._logger=new q("SignoutRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");var a=new URL(t);r&&a.searchParams.append("id_token_hint",r),i&&(a.searchParams.append("post_logout_redirect_uri",i),n&&(this.state=new _e({data:n,request_type:s}),a.searchParams.append("state",this.state.id)));for(var u=0,c=Object.entries(H({},o));u<c.length;u++){var d=c[u],l=d[0],f=d[1];null!=f&&a.searchParams.append(l,f.toString())}this.url=a.href}}())({url:d,id_token_hint:r,post_logout_redirect_uri:s,state_data:n,extraQueryParams:u,request_type:i}),e.next=11,this.clearStaleState();case 11:if(f=l.state,e.t0=f,!e.t0){e.next=17;break}return c.debug("Signout request has state to persist"),e.next=17,this.settings.stateStore.set(f.id,f.toStorageString());case 17:return e.abrupt("return",l);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.readSignoutResponseState=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o,s=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]&&s[1],r=this._logger.create("readSignoutResponseState"),(i=new ve(J.readParams(t,this.settings.response_mode))).state){e.next=6;break}if(r.debug("No state in response"),!i.error){e.next=5;break}throw r.warn("Response was error:",i.error),new Y(i);case 5:return e.abrupt("return",{state:void 0,response:i});case 6:return e.next=8,this.settings.stateStore[n?"remove":"get"](i.state);case 8:if(o=e.sent){e.next=11;break}throw r.throw(new Error("No matching state found in storage")),null;case 11:return e.abrupt("return",{state:_e.fromStorageString(o),response:i});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.processSignoutResponse=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("processSignoutResponse"),e.next=3,this.readSignoutResponseState(t,!0);case 3:return r=e.sent,i=r.state,o=r.response,e.abrupt("return",(i?(n.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(o,i)):n.debug("No state from storage; skipping response validation"),o));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.clearStaleState=function(){return this._logger.create("clearStaleState"),_e.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)},t.revokeToken=function(){var e=(0,o.Z)(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("revokeToken"),e.next=3,this._tokenClient.revoke({token:t,token_type_hint:n});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e}(),we=function(){function e(e){var t=this;this._userManager=e,this._logger=new q("SessionMonitor"),this._start=function(){var e=(0,o.Z)(p().mark((function e(n){var r,i,o,s,a,u,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.session_state){e.next=3;break}return e.abrupt("return");case 3:if(i=t._logger.create("_start"),n.profile?(t._sub=n.profile.sub,t._sid=n.profile.sid,i.debug("session_state",r,", sub",t._sub)):(t._sub=void 0,t._sid=void 0,i.debug("session_state",r,", anonymous user")),!t._checkSessionIFrame){e.next=8;break}t._checkSessionIFrame.start(r),e.next=27;break;case 8:return e.prev=8,e.next=11,t._userManager.metadataService.getCheckSessionIframe();case 11:if(!(o=e.sent)){e.next=21;break}return i.debug("initializing check session iframe"),s=t._userManager.settings.client_id,a=t._userManager.settings.checkSessionIntervalInSeconds,u=t._userManager.settings.stopCheckSessionOnError,c=new ee(t._callback,s,o,a,u),e.next=17,c.load();case 17:t._checkSessionIFrame=c,c.start(r),e.next=22;break;case 21:i.warn("no check session iframe found in the metadata");case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(8),i.error("Error from getCheckSessionIframe:",e.t0 instanceof Error?e.t0.message:e.t0);case 27:case"end":return e.stop()}}),e,null,[[8,24]])})));return function(t){return e.apply(this,arguments)}}(),this._stop=function(){var e=t._logger.create("_stop");if(t._sub=void 0,t._sid=void 0,t._checkSessionIFrame&&t._checkSessionIFrame.stop(),t._userManager.settings.monitorAnonymousSession)var n=setInterval((0,o.Z)(p().mark((function r(){var i,o;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return clearInterval(n),r.prev=1,r.next=4,t._userManager.querySessionStatus();case 4:(i=r.sent)&&(o={session_state:i.session_state,profile:i.sub&&i.sid?{sub:i.sub,sid:i.sid}:null},t._start(o)),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),e.error("error from querySessionStatus",r.t0 instanceof Error?r.t0.message:r.t0);case 11:case"end":return r.stop()}}),r,null,[[1,8]])}))),1e3)},this._callback=(0,o.Z)(p().mark((function e(){var n,r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._logger.create("_callback"),e.prev=1,e.next=4,t._userManager.querySessionStatus();case 4:r=e.sent,i=!0,r&&t._checkSessionIFrame?r.sub===t._sub?(i=!1,t._checkSessionIFrame.start(r.session_state),r.sid===t._sid?n.debug("same sub still logged in at OP, restarting check session iframe; session_state",r.session_state):(n.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",r.session_state),t._userManager.events._raiseUserSessionChanged())):n.debug("different subject signed into OP",r.sub):n.debug("subject no longer signed into OP"),i?t._sub?t._userManager.events._raiseUserSignedOut():t._userManager.events._raiseUserSignedIn():n.debug("no change in session detected, no event to raise"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t._sub&&(n.debug("Error calling queryCurrentSigninSession; raising signed out event",e.t0),t._userManager.events._raiseUserSignedOut());case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),e||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch((function(e){t._logger.error(e)}))}return e.prototype._init=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("_init"),e.next=3,this._userManager.getUser();case 3:if(!(t=e.sent)){e.next=8;break}this._start(t),e.next=13;break;case 8:if(!this._userManager.settings.monitorAnonymousSession){e.next=13;break}return e.next=11,this._userManager.querySessionStatus();case 11:(n=e.sent)&&(r={session_state:n.session_state,profile:n.sub&&n.sid?{sub:n.sub,sid:n.sid}:null},this._start(r));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),Se=function(){function e(e){var t;this.id_token=e.id_token,this.session_state=null!=(t=e.session_state)?t:null,this.access_token=e.access_token,this.refresh_token=e.refresh_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=e.profile,this.expires_at=e.expires_at,this.state=e.userState}return e.prototype.toStorageString=function(){return new q("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},e.fromStorageString=function(t){return q.createStatic("User","fromStorageString"),new e(JSON.parse(t))},(0,u.Z)(e,[{key:"expires_in",get:function(){if(void 0!==this.expires_at)return this.expires_at-Q.getEpochTime()},set:function(e){void 0!==e&&(this.expires_at=Math.floor(e)+Q.getEpochTime())}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}}]),e}(),Ee="oidc-client",be=function(){function e(){this._abort=new W("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}var t=e.prototype;return t.navigate=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o,s=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._logger.create("navigate"),this._window){e.next=3;break}throw new Error("Attempted to navigate on a disposed window");case 3:return n.debug("setting URL in window"),this._window.location.replace(t.url),e.next=6,new Promise((function(e,r){var i=function(i){var o,a=i.data,u=null!=(o=t.scriptOrigin)?o:window.location.origin;if(i.origin===u&&(null==a?void 0:a.source)===Ee){try{var c=J.readParams(a.url,t.response_mode).get("state");if(c||n.warn("no state found in response url"),i.source!==s._window&&c!==t.state)return}catch(t){s._dispose(),r(new Error("Invalid response from window"))}e(a)}};window.addEventListener("message",i,!1),s._disposeHandlers.add((function(){return window.removeEventListener("message",i,!1)})),s._disposeHandlers.add(s._abort.addHandler((function(e){s._dispose(),r(e)})))}));case 6:return r=e.sent,i=r.url,o=r.keepOpen,e.abrupt("return",(n.debug("got response from window"),this._dispose(),o||this.close(),{url:i}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._dispose=function(){this._logger.create("_dispose");for(var e,t=Z(this._disposeHandlers);!(e=t()).done;){(0,e.value)()}this._disposeHandlers.clear()},e._notifyParent=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.location.origin;e.postMessage({source:Ee,url:t,keepOpen:n},r)},e}(),ke={location:!1,toolbar:!1,height:640},ye="_blank",xe=function(e){function t(t){var n,r=t.popup_redirect_uri,i=void 0===r?t.redirect_uri:r,o=t.popup_post_logout_redirect_uri,s=void 0===o?t.post_logout_redirect_uri:o,a=t.popupWindowFeatures,u=void 0===a?ke:a,d=t.popupWindowTarget,l=void 0===d?ye:d,f=t.redirectMethod,p=void 0===f?"assign":f,_=t.redirectTarget,h=void 0===_?"self":_,g=t.iframeNotifyParentOrigin,v=void 0===g?t.iframeNotifyParentOrigin:g,m=t.iframeScriptOrigin,w=void 0===m?t.iframeScriptOrigin:m,S=t.silent_redirect_uri,E=void 0===S?t.redirect_uri:S,b=t.silentRequestTimeoutInSeconds,k=void 0===b?10:b,y=t.automaticSilentRenew,x=void 0===y||y,I=t.validateSubOnSilentRenew,N=void 0===I||I,O=t.includeIdTokenInSilentRenew,T=void 0!==O&&O,R=t.monitorSession,A=void 0!==R&&R,L=t.monitorAnonymousSession,P=void 0!==L&&L,C=t.checkSessionIntervalInSeconds,U=void 0===C?2:C,D=t.query_status_response_type,M=void 0===D?"code":D,j=t.stopCheckSessionOnError,H=void 0===j||j,Z=t.revokeTokenTypes,F=void 0===Z?["access_token","refresh_token"]:Z,B=t.revokeTokensOnSignout,q=void 0!==B&&B,G=t.includeIdTokenInSilentSignout,W=void 0!==G&&G,K=t.accessTokenExpiringNotificationTimeInSeconds,V=void 0===K?60:K,z=t.userStore;if((n=e.call(this,t)||this).popup_redirect_uri=i,n.popup_post_logout_redirect_uri=s,n.popupWindowFeatures=u,n.popupWindowTarget=l,n.redirectMethod=p,n.redirectTarget=h,n.iframeNotifyParentOrigin=v,n.iframeScriptOrigin=w,n.silent_redirect_uri=E,n.silentRequestTimeoutInSeconds=k,n.automaticSilentRenew=x,n.validateSubOnSilentRenew=N,n.includeIdTokenInSilentRenew=T,n.monitorSession=A,n.monitorAnonymousSession=P,n.checkSessionIntervalInSeconds=U,n.stopCheckSessionOnError=H,n.query_status_response_type=M,n.revokeTokenTypes=F,n.revokeTokensOnSignout=q,n.includeIdTokenInSilentSignout=W,n.accessTokenExpiringNotificationTimeInSeconds=V,z)n.userStore=z;else{var Q="undefined"!=typeof window?window.sessionStorage:new te;n.userStore=new ue({store:Q})}return(0,c.Z)(n)}return(0,d.Z)(t,e),t}(ce),Ie=function(e){function t(n){var r,i=n.silentRequestTimeoutInSeconds,o=void 0===i?10:i;return(r=e.call(this)||this)._logger=new q("IFrameWindow"),r._timeoutInSeconds=o,r._frame=t.createHiddenIframe(),r._window=r._frame.contentWindow,r}(0,d.Z)(t,e),t.createHiddenIframe=function(){var e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),window.document.body.appendChild(e),e};var n=t.prototype;return n.navigate=function(){var t=(0,o.Z)(p().mark((function t(n){var r,i=this;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds),r=setTimeout((function(){return i._abort.raise(new X("IFrame timed out without a response"))}),1e3*this._timeoutInSeconds),this._disposeHandlers.add((function(){return clearTimeout(r)})),t.next=5,e.prototype.navigate.call(this,n);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){var e,t=this;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",(function(e){var n,r=e.target;null==(n=r.parentNode)||n.removeChild(r),t._abort.raise(new Error("IFrame removed from DOM"))}),!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null},t.notifyParent=function(t,n){return e._notifyParent.call(this,window.parent,t,!1,n)},t}(be),Ne=function(e){function t(t){var n,r=t.popupWindowTarget,i=void 0===r?ye:r,o=t.popupWindowFeatures,s=void 0===o?{}:o;(n=e.call(this)||this)._logger=new q("PopupWindow");var a=z.center(H(H({},ke),s));return n._window=window.open(void 0,i,z.serialize(a)),n}(0,d.Z)(t,e);var n=t.prototype;return n.navigate=function(){var t=(0,o.Z)(p().mark((function t(n){var r,i,o=this;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==(r=this._window)||r.focus(),i=setInterval((function(){o._window&&!o._window.closed||o._abort.raise(new Error("Popup closed by user"))}),500),this._disposeHandlers.add((function(){return clearInterval(i)})),t.next=5,e.prototype.navigate.call(this,n);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.close=function(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null},t.notifyOpener=function(t,n){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return e._notifyParent.call(this,window.opener,t,n)},t}(be),Oe=function(e){function t(t){var n;return(n=e.call(this,{expiringNotificationTimeInSeconds:t.accessTokenExpiringNotificationTimeInSeconds})||this)._logger=new q("UserManagerEvents"),n._userLoaded=new W("User loaded"),n._userUnloaded=new W("User unloaded"),n._silentRenewError=new W("Silent renew error"),n._userSignedIn=new W("User signed in"),n._userSignedOut=new W("User signed out"),n._userSessionChanged=new W("User session changed"),n}(0,d.Z)(t,e);var n=t.prototype;return n.load=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.prototype.load.call(this,t),n&&this._userLoaded.raise(t)},n.unload=function(){e.prototype.unload.call(this),this._userUnloaded.raise()},n.addUserLoaded=function(e){return this._userLoaded.addHandler(e)},n.removeUserLoaded=function(e){return this._userLoaded.removeHandler(e)},n.addUserUnloaded=function(e){return this._userUnloaded.addHandler(e)},n.removeUserUnloaded=function(e){return this._userUnloaded.removeHandler(e)},n.addSilentRenewError=function(e){return this._silentRenewError.addHandler(e)},n.removeSilentRenewError=function(e){return this._silentRenewError.removeHandler(e)},n._raiseSilentRenewError=function(e){this._silentRenewError.raise(e)},n.addUserSignedIn=function(e){return this._userSignedIn.addHandler(e)},n.removeUserSignedIn=function(e){this._userSignedIn.removeHandler(e)},n._raiseUserSignedIn=function(){this._userSignedIn.raise()},n.addUserSignedOut=function(e){return this._userSignedOut.addHandler(e)},n.removeUserSignedOut=function(e){this._userSignedOut.removeHandler(e)},n._raiseUserSignedOut=function(){this._userSignedOut.raise()},n.addUserSessionChanged=function(e){return this._userSessionChanged.addHandler(e)},n.removeUserSessionChanged=function(e){this._userSessionChanged.removeHandler(e)},n._raiseUserSessionChanged=function(){this._userSessionChanged.raise()},t}($),Te=function(){function e(e){this._logger=new q("UserManager"),this.settings=new xe(e),this._client=new me(e),this._redirectNavigator=new(function(){function e(e){this._settings=e,this._logger=new q("RedirectNavigator")}return e.prototype.prepare=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,s,a,u,c,d,l=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.redirectMethod,r=void 0===n?this._settings.redirectMethod:n,i=t.redirectTarget,s=void 0===i?this._settings.redirectTarget:i,this._logger.create("prepare"),u=window.self,"top"===s&&(u=null!=(a=window.top)?a:window.self),c=u.location[r].bind(u.location),e.abrupt("return",{navigate:function(){var e=(0,o.Z)(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l._logger.create("navigate"),n=new Promise((function(e,t){d=t})),c(t.url),e.next=5,n;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),close:function(){l._logger.create("close"),null==d||d(new Error("Redirect aborted")),u.stop()}});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}())(this.settings),this._popupNavigator=new(function(){function e(e){this._settings=e,this._logger=new q("PopupNavigator")}var t=e.prototype;return t.prepare=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.popupWindowFeatures,r=void 0===n?this._settings.popupWindowFeatures:n,i=t.popupWindowTarget,o=void 0===i?this._settings.popupWindowTarget:i,e.abrupt("return",new Ne({popupWindowFeatures:r,popupWindowTarget:o}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.callback=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.length>1&&void 0!==r[1]&&r[1],this._logger.create("callback"),Ne.notifyOpener(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}())(this.settings),this._iframeNavigator=new(function(){function e(e){this._settings=e,this._logger=new q("IFrameNavigator")}var t=e.prototype;return t.prepare=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.silentRequestTimeoutInSeconds,r=void 0===n?this._settings.silentRequestTimeoutInSeconds:n,e.abrupt("return",new Ie({silentRequestTimeoutInSeconds:r}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.callback=function(){var e=(0,o.Z)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._logger.create("callback"),Ie.notifyParent(t,this._settings.iframeNotifyParentOrigin);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}())(this.settings),this._events=new Oe(this.settings),this._silentRenewService=new(function(){function e(e){var t=this;this._userManager=e,this._logger=new q("SilentRenewService"),this._isStarted=!1,this._retryTimer=new Q("Retry Silent Renew"),this._tokenExpiring=(0,o.Z)(p().mark((function e(){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._logger.create("_tokenExpiring"),e.prev=1,e.next=4,t._userManager.signinSilent();case 4:n.debug("silent token renewal successful"),e.next=12;break;case 7:if(e.prev=7,e.t0=e.catch(1),!(e.t0 instanceof X)){e.next=11;break}return e.abrupt("return",(n.warn("ErrorTimeout from signinSilent:",e.t0,"retry in 5s"),void t._retryTimer.init(5)));case 11:n.error("Error from signinSilent:",e.t0),t._userManager.events._raiseSilentRenewError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})))}var t=e.prototype;return t.start=function(){var e=(0,o.Z)(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._logger.create("start"),this._isStarted){e.next=11;break}return this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring),e.prev=3,e.next=6,this._userManager.getUser();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),t.error("getUser error",e.t0);case 11:case"end":return e.stop()}}),e,this,[[3,8]])})));return function(){return e.apply(this,arguments)}}(),t.stop=function(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)},e}())(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new we(this))}var t=e.prototype;return t.getUser=function(){var e=(0,o.Z)(p().mark((function e(){var t,n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._logger.create("getUser"),e.next=3,this._loadUser();case 3:return n=e.sent,e.abrupt("return",n?(t.info("user loaded"),this._events.load(n,!1),n):(t.info("user not found in storage"),null));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.removeUser=function(){var e=(0,o.Z)(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._logger.create("removeUser"),e.next=3,this.storeUser(null);case 3:t.info("user removed from storage"),this._events.unload();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signinRedirect=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,o,s=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},this._logger.create("signinRedirect"),n=t.redirectMethod,r=(0,i.Z)(t,A),e.next=6,this._redirectNavigator.prepare({redirectMethod:n});case 6:return o=e.sent,e.next=9,this._signinStart(H({request_type:"si:r"},r),o);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signinRedirectCallback=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,i=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:window.location.href,n=this._logger.create("signinRedirectCallback"),e.next=4,this._signinEnd(t);case 4:return r=e.sent,e.abrupt("return",(r.profile&&r.profile.sub?n.info("success, signed in subject",r.profile.sub):n.info("no subject"),r));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signinResourceOwnerCredentials=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o,s,a,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,i=t.skipUserInfo,o=void 0!==i&&i,s=this._logger.create("signinResourceOwnerCredential"),e.next=4,this._client.processResourceOwnerPasswordCredentials({username:n,password:r,skipUserInfo:o,extraTokenParams:this.settings.extraTokenParams});case 4:return a=e.sent,s.debug("got signin response"),e.next=8,this._buildUser(a);case 8:return u=e.sent,e.abrupt("return",(u.profile&&u.profile.sub?s.info("success, signed in subject",u.profile.sub):s.info("no subject"),u));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.signinPopup=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,o,s,a,u,c,d=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},n=this._logger.create("signinPopup"),r=t.popupWindowFeatures,o=t.popupWindowTarget,s=(0,i.Z)(t,L),(a=this.settings.popup_redirect_uri)||n.throw(new Error("No popup_redirect_uri configured")),e.next=5,this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:o});case 5:return u=e.sent,e.next=8,this._signin(H({request_type:"si:p",redirect_uri:a,display:"popup"},s),u);case 8:return c=e.sent,e.abrupt("return",(c&&(c.profile&&c.profile.sub?n.info("success, signed in subject",c.profile.sub):n.info("no subject")),c));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signinPopupCallback=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,i=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:window.location.href,n=i.length>1&&void 0!==i[1]&&i[1],r=this._logger.create("signinPopupCallback"),e.next=4,this._popupNavigator.callback(t,n);case 4:r.info("success");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signinSilent=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,o,s,a,u,c,d,l,f=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:{},r=this._logger.create("signinSilent"),o=t.silentRequestTimeoutInSeconds,s=(0,i.Z)(t,P),e.next=4,this._loadUser();case 4:if(!(null==(a=e.sent)?void 0:a.refresh_token)){e.next=11;break}return r.debug("using refresh token"),u=new(function(){return function(e){this.refresh_token=e.refresh_token,this.id_token=e.id_token,this.session_state=e.session_state,this.scope=e.scope,this.profile=e.profile,this.data=e.state}}())(a),e.next=10,this._useRefreshToken(u);case 10:return e.abrupt("return",e.sent);case 11:return(c=this.settings.silent_redirect_uri)||r.throw(new Error("No silent_redirect_uri configured")),a&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",a.profile.sub),d=a.profile.sub),e.next=15,this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:o});case 15:return l=e.sent,e.next=18,this._signin(H({request_type:"si:s",redirect_uri:c,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==a?void 0:a.id_token:void 0},s),l,d);case 18:return(a=e.sent)&&((null==(n=a.profile)?void 0:n.sub)?r.info("success, signed in subject",a.profile.sub):r.info("no subject")),e.abrupt("return",a);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t._useRefreshToken=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._client.useRefreshToken({state:t,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds});case 2:return n=e.sent,r=new Se(H(H({},t),n)),e.next=6,this.storeUser(r);case 6:return this._events.load(r),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.signinSilentCallback=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:window.location.href,n=this._logger.create("signinSilentCallback"),e.next=4,this._iframeNavigator.callback(t);case 4:n.info("success");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signinCallback=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,i=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:window.location.href,e.next=3,this._client.readSigninResponseState(t);case 3:n=e.sent,r=n.state,e.t0=r.request_type,e.next="si:r"===e.t0?8:"si:p"===e.t0?11:"si:s"===e.t0?14:17;break;case 8:return e.next=10,this.signinRedirectCallback(t);case 10:case 13:case 16:return e.abrupt("return",e.sent);case 11:return e.next=13,this.signinPopupCallback(t);case 14:return e.next=16,this.signinSilentCallback(t);case 17:throw new Error("invalid response_type in state");case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signoutCallback=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,i,o=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:window.location.href,n=o.length>1&&void 0!==o[1]&&o[1],e.next=3,this._client.readSignoutResponseState(t);case 3:if(r=e.sent,!(i=r.state)){e.next=19;break}e.t0=i.request_type,e.next="so:r"===e.t0?9:"so:p"===e.t0?12:"so:s"===e.t0?15:18;break;case 9:return e.next=11,this.signoutRedirectCallback(t);case 11:case 14:case 17:return e.abrupt("break",19);case 12:return e.next=14,this.signoutPopupCallback(t,n);case 15:return e.next=17,this.signoutSilentCallback(t);case 18:throw new Error("invalid response_type in state");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.querySessionStatus=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,o,s,a,u,c,d,l=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},n=this._logger.create("querySessionStatus"),r=t.silentRequestTimeoutInSeconds,o=(0,i.Z)(t,C),(s=this.settings.silent_redirect_uri)||n.throw(new Error("No silent_redirect_uri configured")),e.next=5,this._loadUser();case 5:return a=e.sent,e.next=8,this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r});case 8:return u=e.sent,e.next=11,this._signinStart(H({request_type:"si:s",redirect_uri:s,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==a?void 0:a.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0},o),u);case 11:return c=e.sent,e.prev=12,e.next=15,this._client.processSigninResponse(c.url);case 15:return d=e.sent,e.abrupt("return",(n.debug("got signin response"),d.session_state&&d.profile.sub?(n.info("success for subject",d.profile.sub),{session_state:d.session_state,sub:d.profile.sub,sid:d.profile.sid}):(n.info("success, user not authenticated"),null)));case 19:if(e.prev=19,e.t0=e.catch(12),!(this.settings.monitorAnonymousSession&&e.t0 instanceof Y)){e.next=26;break}e.t1=e.t0.error,e.next="login_required"===e.t1||"consent_required"===e.t1||"interaction_required"===e.t1||"account_selection_required"===e.t1?25:26;break;case 25:return e.abrupt("return",(n.info("success for anonymous user"),{session_state:e.t0.session_state}));case 26:throw e.t0;case 27:case"end":return e.stop()}}),e,this,[[12,19]])})));return function(){return e.apply(this,arguments)}}(),t._signin=function(){var e=(0,o.Z)(p().mark((function e(t,n,r){var i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._signinStart(t,n);case 2:return i=e.sent,e.next=5,this._signinEnd(i.url,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t._signinStart=function(){var e=(0,o.Z)(p().mark((function e(t,n){var r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("_signinStart"),e.prev=1,e.next=4,this._client.createSigninRequest(t);case 4:return i=e.sent,r.debug("got signin request"),e.next=8,n.navigate({url:i.url,state:i.state.id,response_mode:i.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin});case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(1),r.debug("error after preparing navigator, closing navigator window"),n.close(),e.t0;case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}(),t._signinEnd=function(){var e=(0,o.Z)(p().mark((function e(t,n){var r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("_signinEnd"),e.next=3,this._client.processSigninResponse(t);case 3:return i=e.sent,r.debug("got signin response"),e.next=7,this._buildUser(i,n);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t._buildUser=function(){var e=(0,o.Z)(p().mark((function e(t,n){var r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._logger.create("_buildUser"),i=new Se(t),!n){e.next=5;break}if(n===i.profile.sub){e.next=4;break}throw r.debug("current user does not match user returned from signin. sub from signin:",i.profile.sub),new Y(H(H({},t),{},{error:"login_required"}));case 4:r.debug("current user matches user returned from signin");case 5:return e.next=7,this.storeUser(i);case 7:return r.debug("user stored"),this._events.load(i),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.signoutRedirect=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,o,s,a=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},n=this._logger.create("signoutRedirect"),r=t.redirectMethod,o=(0,i.Z)(t,U),e.next=6,this._redirectNavigator.prepare({redirectMethod:r});case 6:return s=e.sent,e.next=9,this._signoutStart(H({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri},o),s);case 9:n.info("success");case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signoutRedirectCallback=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,i=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:window.location.href,n=this._logger.create("signoutRedirectCallback"),e.next=4,this._signoutEnd(t);case 4:return r=e.sent,e.abrupt("return",(n.info("success"),r));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signoutPopup=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,o,s,a,u,c=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},n=this._logger.create("signoutPopup"),r=t.popupWindowFeatures,o=t.popupWindowTarget,s=(0,i.Z)(t,D),a=this.settings.popup_post_logout_redirect_uri,e.next=8,this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:o});case 8:return u=e.sent,e.next=11,this._signout(H({request_type:"so:p",post_logout_redirect_uri:a,state:null==a?void 0:{}},s),u);case 11:n.info("success");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signoutPopupCallback=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,i=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:window.location.href,n=i.length>1&&void 0!==i[1]&&i[1],r=this._logger.create("signoutPopupCallback"),e.next=4,this._popupNavigator.callback(t,n);case 4:r.info("success");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t._signout=function(){var e=(0,o.Z)(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._signoutStart(t,n);case 2:return r=e.sent,e.next=5,this._signoutEnd(r.url);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t._signoutStart=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,i,o,s,a,u=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},n=u.length>1?u[1]:void 0,i=this._logger.create("_signoutStart"),e.prev=2,e.next=5,this._loadUser();case 5:if(o=e.sent,i.debug("loaded current user from storage"),e.t0=this.settings.revokeTokensOnSignout,!e.t0){e.next=11;break}return e.next=11,this._revokeInternal(o);case 11:return(s=t.id_token_hint||o&&o.id_token)&&(i.debug("setting id_token_hint in signout request"),t.id_token_hint=s),e.next=15,this.removeUser();case 15:return i.debug("user removed, creating signout request"),e.next=18,this._client.createSignoutRequest(t);case 18:return a=e.sent,i.debug("got signout request"),e.next=22,n.navigate({url:a.url,state:null==(r=a.state)?void 0:r.id});case 22:return e.abrupt("return",e.sent);case 25:throw e.prev=25,e.t1=e.catch(2),i.debug("error after preparing navigator, closing navigator window"),n.close(),e.t1;case 28:case"end":return e.stop()}}),e,this,[[2,25]])})));return function(){return e.apply(this,arguments)}}(),t._signoutEnd=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("_signoutEnd"),e.next=3,this._client.processSignoutResponse(t);case 3:return r=e.sent,e.abrupt("return",(n.debug("got signout response"),r));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.signoutSilent=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r,o,s,a,u,c,d=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:{},r=this._logger.create("signoutSilent"),o=t.silentRequestTimeoutInSeconds,s=(0,i.Z)(t,M),!this.settings.includeIdTokenInSilentSignout){e.next=16;break}return e.next=7,this._loadUser();case 7:if(e.t1=n=e.sent,null!=e.t1){e.next=12;break}e.t2=void 0,e.next=13;break;case 12:e.t2=n.id_token;case 13:e.t0=e.t2,e.next=17;break;case 16:e.t0=void 0;case 17:return a=e.t0,u=this.settings.popup_post_logout_redirect_uri,e.next=21,this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:o});case 21:return c=e.sent,e.next=24,this._signout(H({request_type:"so:s",post_logout_redirect_uri:u,id_token_hint:a},s),c);case 24:r.info("success");case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signoutSilentCallback=function(){var e=(0,o.Z)(p().mark((function e(){var t,n,r=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:window.location.href,n=this._logger.create("signoutSilentCallback"),e.next=4,this._iframeNavigator.callback(t);case 4:n.info("success");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.revokeTokens=function(){var e=(0,o.Z)(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadUser();case 2:return n=e.sent,e.next=5,this._revokeInternal(n,t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._revokeInternal=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r,i,o,s,a,u=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:this.settings.revokeTokenTypes,r=this._logger.create("_revokeInternal"),t){e.next=4;break}return e.abrupt("return");case 4:if(!(i=n.filter((function(e){return"string"==typeof t[e]}))).length){e.next=21;break}o=Z(i);case 7:if((s=o()).done){e.next=15;break}return a=s.value,e.next=11,this._client.revokeToken(t[a],a);case 11:r.info(a+" revoked successfully"),"access_token"!==a&&(t[a]=null);case 13:e.next=7;break;case 15:return e.next=17,this.storeUser(t);case 17:r.debug("user stored"),this._events.load(t),e.next=22;break;case 21:r.debug("no need to revoke due to no token(s)");case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.startSilentRenew=function(){this._logger.create("startSilentRenew"),this._silentRenewService.start()},t.stopSilentRenew=function(){this._silentRenewService.stop()},t._loadUser=function(){var e=(0,o.Z)(p().mark((function e(){var t,n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._logger.create("_loadUser"),e.next=3,this.settings.userStore.get(this._userStoreKey);case 3:return n=e.sent,e.abrupt("return",n?(t.debug("user storageString loaded"),Se.fromStorageString(n)):(t.debug("no user storageString"),null));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.storeUser=function(){var e=(0,o.Z)(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._logger.create("storeUser"),!t){e.next=8;break}return n.debug("storing user"),r=t.toStorageString(),e.next=6,this.settings.userStore.set(this._userStoreKey,r);case 6:e.next=11;break;case 8:return this._logger.debug("removing user"),e.next=11,this.settings.userStore.remove(this._userStoreKey);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.clearStaleState=function(){var e=(0,o.Z)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._client.clearStaleState();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),(0,u.Z)(e,[{key:"events",get:function(){return this._events}},{key:"metadataService",get:function(){return this._client.metadataService}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),e}(),Re="2.2.2"}));function fe(e,t){return e.then((function(e){return[null,e]})).catch((function(e){return t&&Object.assign(e,t),[e,void 0]}))}var pe="oidcClient",_e={NO_SESSION:"NO_SESSION",VALID_SESSION:"VALID_SESSION",LOGGING_IN:"LOGGING_IN",LOGGING_OUT:"LOGGING_OUT",HANDLING_LOGIN_CALLBACK:"HANDLING_LOGIN_CALLBACK"},he={USER_UPDATED:"USER_UPDATED",USER_RENEWAL_STARTED:"USER_RENEWAL_STARTED",USER_REMOVED:"USER_REMOVED"},ge={INVALID_OR_EXPIRED_USER:"INVALID_OR_EXPIRED_USER",SIGNIN_ERROR:"SIGNIN_ERROR",RENEWAL_FAILED:"RENEWAL_FAILED"},ve=function(e){function t(t,n,r){var i;return(i=e.call(this,t)||this).message=t,i.type=n,i.originalError=r,i.type=n,i.originalError=r,i}return(0,d.Z)(t,e),(0,u.Z)(t,[{key:"isInvalidUserError",get:function(){return this.type===ge.INVALID_OR_EXPIRED_USER}},{key:"isSignInError",get:function(){return this.type===ge.SIGNIN_ERROR}},{key:"isRenewalError",get:function(){return this.type===ge.RENEWAL_FAILED}}]),t}((0,a.Z)(Error));function me(e,t,n){if(!e||!t)return!1;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return!1;if(n&&n.compareSourcePrototype){var r=Reflect.getPrototypeOf(e),i=Reflect.getPrototypeOf(t);if(Object.keys(r).length&&!me(r,i,n))return!1}var o=Object.keys(e);return 0===o.length||-1===o.findIndex((function(r){var i=e[r],o=typeof i,s=t[r];return o!==typeof s||("number"===o&&Number.isNaN(i)?!Number.isNaN(s):i&&"object"===o?!me(i,s,n):i!==s)}))}var we="*",Se=":";function Ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(void 0!==e.namespace)return e;var n=("string"==typeof e?e:e.type).split(Se);return{type:n[0]||"",namespace:n[1]||t}}function be(e){var t="string"==typeof e?Ee(e):Object.assign({},e);return t.context?Object.assign(Object.assign({},t),{context:t.context?{namespace:t.context.namespace}:void 0}):t}function ke(e,t){var n=Object.assign({},e);return e.type&&e.type!==we||(n.type=t.type),e.namespace&&e.namespace!==we||(n.namespace=t.namespace),me(n,t)}function ye(e){var t=be(e);return function(e){var n=e.type&&e.type!==we,r=e.namespace;if(!n||!r)return!1;var i=t.context?be(e):e;return ke(t,i)}}function xe(){var e=!1,t=new Set,n=[],r=new Set,i=new Map,o=function e(){var r=[].concat(n);n.length=0,r.forEach((function(e){!function(e){var n=function(e){var t=Ee(e,we),n=e.context||i.get(t.namespace)||void 0;return Object.assign(Object.assign(Object.assign({},e),t),{context:n})}(e);t.forEach((function(e){var t=e.listener;(0,e.trigger)(n)&&t(n)})),function(e){e.context=void 0,e.type=void 0,e.namespace=void 0,e.payload=void 0}(n)}(e)})),n.length&&e()},s={emit:function(i){e?n.push(i):(e=!0,n.push(i),o(),r.size?r.forEach((function(e){t.add(e)})):r.clear(),e=!1)},addListener:function(n,i){var o={listener:i,trigger:"function"==typeof n?n:ye(n)};return e?r.add(o):t.add(o),function(){t.delete(o),r.delete(o)}},clear:function(){t.clear(),i.clear(),n.length=0},addSignalContext:function(e){var t=e.namespace;if(!t)throw new Error("SignalContext "+t+" has no namespace");if(i.has(t))throw new Error("SignalContext "+t+" already exists");return i.set(t,e),e.connect(s),function(){i.delete(t)}},getSignalContext:function(e){return i.get(e)},getAllSignalContextsAsObject:function(){var e={};return i.forEach((function(t,n){e[n]=t})),e}};return s}var Ie="error",Ne="event",Oe="init",Te="stateChange";function Re(e){var t,n=[];return{storeBeacon:function(e){t=e,n.forEach((function(e){e(t)})),n.length=0},emit:function(n,r){return t?t.emit({type:n,namespace:e,payload:r}):void 0},emitError:function(n){return t?t.emit({type:Ie,namespace:e,payload:n}):void 0},emitStateChange:function(n,r){var i={state:n,previousState:r};return t?t.emit({type:Te,namespace:e,payload:i}):void 0},emitEvent:function(n,r){var i={type:n,data:r};return t?t.emit({type:Ne,namespace:e,payload:i}):void 0},addListener:function(r,i){var o=this,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Ee(r,we),u=a.type,c=a.namespace;if(c===e)return function(){};var d="*"===c&&s?function(n){if(n.namespace!==e)return i(n,o,t)}:function(e){return i(e,o,t)};return t?t.addListener({type:u,namespace:c},d):function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=[function(){}];return n.push((function(e){i[0]=e.addListener.apply(e,t)})),function(){i[0]()}}({type:u,namespace:c},d)},namespace:e}}function Ae(e,t,n,r){return Object.assign(Object.assign({type:e,namespace:t},n&&{payload:n}),r&&{context:r})}function Le(e,t){return Ae(Ie,e,t)}function Pe(e,t){return Ae(Ne,e,t)}function Ce(e,t){return Ae(Te,e,t)}function Ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;return Object.assign({type:Ie,namespace:e},t&&{payload:{type:t}})}function De(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;return Object.assign({type:Ne,namespace:e},t&&{payload:{type:t}})}function Me(){return{type:Oe,namespace:arguments.length>0&&void 0!==arguments[0]?arguments[0]:we}}function je(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=t?Object.assign(Object.assign({},t&&{state:t}),n&&{previousState:n}):void 0;return Object.assign({type:Te,namespace:e},r&&{payload:r})}function He(){return{type:we,namespace:arguments.length>0&&void 0!==arguments[0]?arguments[0]:we}}function Ze(){return{type:we}}function Fe(){return{namespace:we}}function Be(e){return Object.prototype.hasOwnProperty.call(e,"context")?{type:e.type,namespace:e.namespace,payload:e.payload}:e}function qe(e,t){var n=Object.keys(t);return e.filter((function(e){return!n.find((function(n){return t[n]!==e[n]}))}))}function Ge(e){return e.type===Ne}function We(e){return e.type===Ie}function Ke(e){return e.type===Oe}function Ve(e){return e.type===Te}function ze(e,t){return e.namespace===t}function Qe(e){return Ge(e)&&e.payload&&e.payload.type?e.payload:null}function Je(e){return Ve(e)&&e.payload&&e.payload.state?e.payload:null}function Ye(e){return We(e)&&e.payload||null}function Xe(e,t){var n=Qe(e);return!!n&&t(n)}function $e(e,t){var n=Ye(e);return!!n&&t(n)}function et(e){var t=e.getAllSignalContextsAsObject();Object.keys(t).forEach((function(n){e.emit({type:Oe,namespace:n,context:t[n]})}))}function tt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{allowSkipping:!0,strictOrder:!1};return new Promise((function(r,i){var o=n.strictOrder,s=n.rejectOn,a=n.allowSkipping,u=t.map((function(e){return be(e)})),c=s&&s.length?s.map((function(e){return be(e)})):[],d=[],l=[function(){},!1],f=function(){return l[1]},p=function(){f()||("function"==typeof l[0]&&l[0](),l[0]=void 0,l[1]=!0)};l[0]=e.addListener(He(),(function(e){if(!f()){var t=be(e);if(function(e){return!!s&&!!c.find((function(t){return ke(t,e)}))}(t))return p(),void i(new Error("options.rejectOn includes "+t.type+":"+t.namespace));var n=u.findIndex((function(e){return ke(e,t)}));if(n>-1){if(o&&0!==n)return p(),void i(new Error("Signal "+t.type+":"+t.namespace+" emitted in wrong order #"+d.length+" while strictOrder = true"));0!==n?a?u.splice(0,n+1):u.splice(n,1):u.shift(),d.push(t),0===u.length&&(p(),r(d))}}}))}))}var nt=function(e){return{userManagerSettings:{automaticSilentRenew:!0,redirect_uri:e+"/callback",silent_redirect_uri:e+"/silent_renew.html",response_type:"code",post_logout_redirect_uri:e+"/",monitorSession:!1,includeIdTokenInSilentRenew:!0,validateSubOnSilentRenew:!1,loadUserInfo:!0}}},rt=function(e){return"oidc.user:"+e.authority+":"+e.client_id},it=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.sessionStorage).getItem(rt(e));if(!t)return null;try{return le.User.fromStorageString(t)}catch(e){return null}},ot=function(e){if(!e)return!0;if(void 0!==e.expired)return e.expired;var t=e.expires_at;return!t||t-Date.now()/1e3<=0},st=function(e){return!!e&&!ot(e)&&!!e.access_token},at=function(e,t){if(st(e))return e[t+"_token"]};function ut(e){var t,n=this,r=this,i=e.userManagerSettings,o=(0,v._)(e,["userManagerSettings"]),s=nt(window.location.origin),a=s.userManagerSettings,u=(0,v._)(s,["userManagerSettings"]),c=window.sessionStorage,d=Object.assign(Object.assign(Object.assign({},u),o),{userManagerSettings:Object.assign(Object.assign(Object.assign({},a),i),{userStore:new le.WebStorageStateStore({store:c})})}),l=_e.NO_SESSION,f=function(){return!!t};d.debug&&(le.Log.setLevel(le.Log.DEBUG),le.Log.setLogger(console));var _=Re(pe),h=function(e){if(l!==e){var t=l;l=e,_.emitStateChange(l,t)}},g=function(e,t){return _.emitEvent(e,t)},m=function(e){return _.emitError(e)},w=new le.UserManager(d.userManagerSettings),S=function(){return it(d.userManagerSettings,c)||null},E=function(e){var t=e||{},n=t.extraQueryParams,r=void 0===n?{}:n,i=t.language,o=(0,v._)(t,["extraQueryParams","language"]);return i&&(r.ui_locales=i),Object.assign({extraQueryParams:r},o)},b=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).triggerSigninSilent,i=void 0!==e&&e;return(0,v.a)(r,void 0,void 0,p().mark((function e(){var r,o,s,a,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f()){e.next=2;break}return e.abrupt("return",t);case 2:if(t=(0,v.a)(n,void 0,void 0,p().mark((function e(){var t,n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fe(function(e){return new Promise((function(t,n){var r=!1,i=function(e){r||(r=!0,s(),t(e))},o=function(){r||(r=!0,s(),n(new Error("Renewal failed")))},s=function(){e.events.removeUserLoaded(i),e.events.removeSilentRenewError(o),e.events.removeUserUnloaded(o)};e.events.addUserLoaded(i),e.events.addSilentRenewError(o),e.events.addUserUnloaded(o)}))}(w));case 2:return t=e.sent,n=t[0],r=t[1],e.abrupt("return",Promise.resolve([n?new ve("Renew failed",ge.RENEWAL_FAILED,n):null,r]));case 6:case"end":return e.stop()}}),e)}))),g(he.USER_RENEWAL_STARTED),!i){e.next=8;break}return e.next=5,fe(w.signinSilent());case 5:r=e.sent,(o=r[0])&&w.events._raiseSilentRenewError(o);case 8:return e.next=10,t;case 10:return s=e.sent,a=s[0],u=s[1],e.abrupt("return",(a&&m(a),g(he.USER_UPDATED,u||null),t=void 0,Promise.resolve([a,u])));case 14:case"end":return e.stop()}}),e)})))};return w.events.addAccessTokenExpiring((function(){b()})),w.events.addUserUnloaded((function(){g(he.USER_REMOVED)})),st(S())&&(l=_e.VALID_SESSION),{connect:function(e){_.storeBeacon(e)},getAmr:function(){var e=S();if(e&&e.id_token){if(e.profile&&Array.isArray(e.profile.amr))return e.profile.amr.length?e.profile.amr:void 0;try{var t=ce(e.id_token).amr;if(!t)return;return Array.isArray(t)?t:[t]}catch(e){return}}},getState:function(){return l},getToken:function(e){return(0,v.a)(n,void 0,void 0,p().mark((function n(){var r;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=f(),!n.t0){n.next=4;break}return n.next=4,t;case 4:return r=S(),n.abrupt("return",at(r,e));case 6:case"end":return n.stop()}}),n)})))},getUser:function(){return S()},getUserManager:function(){return w},handleCallback:function(){return(0,v.a)(n,void 0,void 0,p().mark((function e(){var t,n,r,i,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(_e.HANDLING_LOGIN_CALLBACK),e.next=3,fe(w.signinRedirectCallback());case 3:if(t=e.sent,n=t[0],r=t[1],i=st(r),!n&&i){e.next=10;break}return o=n?new ve("SigninRedirectCallback returned an error",ge.SIGNIN_ERROR,n):new ve("SigninRedirectCallback returned invalid or expired user",ge.INVALID_OR_EXPIRED_USER),e.abrupt("return",(m(o),h(_e.NO_SESSION),Promise.reject(o)));case 10:return e.abrupt("return",(h(_e.VALID_SESSION),g(he.USER_UPDATED,r),Promise.resolve(r)));case 11:case"end":return e.stop()}}),e)})))},isAuthenticated:function(){var e=it(d.userManagerSettings,c);return!!e&&st(e)},isRenewing:f,login:function(e){return(0,v.a)(n,void 0,void 0,p().mark((function t(){var n,r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h(_e.LOGGING_IN),t.next=3,fe(w.signinRedirect(E(e)));case 3:return n=t.sent,r=n[0],t.abrupt("return",(r&&m(new ve("Login redirect failed",ge.SIGNIN_ERROR,r)),Promise.resolve()));case 6:case"end":return t.stop()}}),t)})))},logout:function(e){return(0,v.a)(n,void 0,void 0,p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(h(_e.LOGGING_OUT),w.signoutRedirect(E(e))));case 1:case"end":return t.stop()}}),t)})))},namespace:pe,renewUser:function(){return(0,v.a)(n,void 0,void 0,p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b({triggerSigninSilent:!0}));case 1:case"end":return e.stop()}}),e)})))}}}var ct=(0,_.createContext)({addListener:function(){throw new Error("LoginContext.addListener is not initialized")},getModule:function(){throw new Error("LoginContext.getModule is not initialized")}}),dt=function(e){var t=e.children,n=e.loginProps,r=e.modules,i=(0,_.useMemo)((function(){return xe()}),[]),o=(0,_.useMemo)((function(){return ut(Object.assign({},n))}),[]);(0,_.useMemo)((function(){r&&r.forEach((function(e){i.addSignalContext(e)})),i.addSignalContext(o),et(i)}),[]);var s={addListener:function(e,t){return i.addListener(e,t)},getModule:function(e){return i.getSignalContext(e)}};return _.createElement(ct.Provider,{value:s},t)},lt=(0,y.c)((function(e,t){var n;t.__esModule=!0,function(e){e[e.CONTINUE=100]="CONTINUE",e[e.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",e[e.PROCESSING=102]="PROCESSING",e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.RESET_CONTENT=205]="RESET_CONTENT",e[e.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.ALREADY_REPORTED=208]="ALREADY_REPORTED",e[e.IM_USED=226]="IM_USED",e[e.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",e[e.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",e[e.FOUND=302]="FOUND",e[e.SEE_OTHER=303]="SEE_OTHER",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.USE_PROXY=305]="USE_PROXY",e[e.SWITCH_PROXY=306]="SWITCH_PROXY",e[e.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",e[e.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",e[e.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.PAYLOAD_TOO_LARGE=413]="PAYLOAD_TOO_LARGE",e[e.URI_TOO_LONG=414]="URI_TOO_LONG",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.RANGE_NOT_SATISFIABLE=416]="RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.I_AM_A_TEAPOT=418]="I_AM_A_TEAPOT",e[e.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.LOCKED=423]="LOCKED",e[e.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",e[e.UPGRADE_REQUIRED=426]="UPGRADE_REQUIRED",e[e.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",e[e.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",e[e.VARIANT_ALSO_NEGOTIATES=506]="VARIANT_ALSO_NEGOTIATES",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.LOOP_DETECTED=508]="LOOP_DETECTED",e[e.NOT_EXTENDED=510]="NOT_EXTENDED",e[e.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED"}(n||(n={})),t.default=n})),ft=(0,y.d)(lt);function pt(e){return!!e&&"AbortError"===e.name}function _t(){var e,t=!1,n=function(){!t&&e&&(t=!0,e.abort(),e=void 0)};return{isAborted:function(){return t},getSignal:function(){return n(),t=!1,(e=new AbortController).signal},abort:n}}var ht=6e4;function gt(e){return!!e&&(e&&e.status)===ft.OK}function vt(e){var t,n=this,r=e.pollFunction,i=e.shouldPoll,o=e.onError,s=e.onSuccess,a=e.pollIntervalInMs,u=void 0===a?ht:a,c=!1,d=!1,l=function(){return(0,v.a)(n,void 0,void 0,p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=!0,e.next=3,fe(r());case 3:return t=e.sent,e.abrupt("return",(c=!1,t));case 5:case"end":return e.stop()}}),e)})))},f=function e(){t&&clearTimeout(t),t=setTimeout((function(){t=void 0,!c&&i()?_():e()}),u)},_=function(){return(0,v.a)(n,void 0,void 0,p().mark((function e(){var t,n,r,i,a,u,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:if(t=e.sent,n=t[0],r=t[1],!d){e.next=7;break}return e.abrupt("return");case 7:if(i=r&&r.status,a=!gt(r),!(u=!n&&!a)||!s){e.next=12;break}if(c=s(r),c.keepPolling){e.next=12;break}return e.abrupt("return");case 12:n&&pt(n)||(u||o(i).keepPolling)&&f();case 13:case"end":return e.stop()}}),e)})))};return{start:function(){d=!1,f()},stop:function(){t&&(clearTimeout(t),t=void 0),d=!0}}}function mt(e){return e.context&&e.context.namespace===pe&&e.context.getUser?e.context:null}function wt(e){var t=Qe(e);if(t&&t.data&&st(t.data))return t.data;var n=mt(e);if(!n)return null;var r=n.getUser();return st(r)?r:null}var St={SESSION_ENDED:"SESSION_ENDED",SESSION_POLLING_FAILED:"SESSION_POLLING_FAILED"},Et=function(e){function t(t,n,r){var i;return(i=e.call(this,t)||this).message=t,i.type=n,i.originalError=r,i.type=n,i.originalError=r,i}return(0,d.Z)(t,e),(0,u.Z)(t,[{key:"isSessionEnded",get:function(){return this.type===St.SESSION_ENDED}},{key:"isSessionPollingFailure",get:function(){return this.type===St.SESSION_POLLING_FAILED}}]),t}((0,a.Z)(Error));function bt(e){return ye(Ue(pe,e))}function kt(e){return ye(De(pe,e))}function yt(e,t){return ye(je(pe,e,t))}function xt(e,t){return Tt(e)&&function(e,t){var n=Je(e);return!!n&&t(n)}(e,(function(e){return e.state===t}))}function It(e,t){return Tt(e)&&Xe(e,(function(e){return e.type===t}))}function Nt(){return He(pe)}var Ot=ye(Nt());function Tt(e){return ze(e,pe)}function Rt(e){return Ce(pe,e)}function At(e){return Tt(e)?Je(e):null}function Lt(e){return!!e&&xt(e,_e.LOGGING_OUT)}function Pt(e){return!!e&&xt(e,_e.LOGGING_IN)}function Ct(e){return!!e&&xt(e,_e.HANDLING_LOGIN_CALLBACK)}function Ut(e){return!!e&&xt(e,_e.NO_SESSION)}function Dt(e){return!!e&&xt(e,_e.VALID_SESSION)}function Mt(){return je(pe)}var jt=ye(Mt()),Ht=yt(_e.LOGGING_OUT),Zt=yt(_e.LOGGING_IN),Ft=yt(_e.HANDLING_LOGIN_CALLBACK),Bt=yt(_e.VALID_SESSION),qt=yt(_e.NO_SESSION);function Gt(e){return Pe(pe,e)}function Wt(){return De(pe)}var Kt=ye(Wt());function Vt(e){return Tt(e)?Qe(e):null}function zt(e){return!!e&&It(e,he.USER_REMOVED)}function Qt(e){return!!e&&It(e,he.USER_RENEWAL_STARTED)}function Jt(e){return!!e&&It(e,he.USER_UPDATED)}var Yt=kt(he.USER_REMOVED),Xt=kt(he.USER_RENEWAL_STARTED),$t=kt(he.USER_UPDATED);function en(e){return Le(pe,e)}function tn(){return Ue(pe)}var nn=ye(tn());function rn(e){return Tt(e)?Ye(e):null}function on(e){return Tt(e)&&$e(e,(function(e){return e.isInvalidUserError}))}function sn(e){return Tt(e)&&$e(e,(function(e){return e.isRenewalError}))}function an(e){return Tt(e)&&$e(e,(function(e){return e.isSignInError}))}var un=bt(ge.RENEWAL_FAILED),cn=bt(ge.INVALID_OR_EXPIRED_USER),dn=bt(ge.SIGNIN_ERROR),ln="sessionPoller",fn={SESSION_POLLING_STARTED:"SESSION_POLLING_STARTED",SESSION_POLLING_STOPPED:"SESSION_POLLING_STOPPED"};function pn(){var e,t,n=this,r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pollIntervalInMs:6e4}).pollIntervalInMs,i=_t(),o=Re(ln),s=function(){return t===_e.VALID_SESSION},a=vt({pollIntervalInMs:r,pollFunction:function(){return(0,v.a)(n,void 0,void 0,p().mark((function t(){var n,r,s,a,u;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",Promise.resolve(void 0));case 2:return t.next=4,e.metadataService.getUserInfoEndpoint();case 4:return n=t.sent,t.next=7,e.getUser();case 7:if(r=t.sent,s=r&&r.access_token){t.next=11;break}return t.abrupt("return",Promise.reject(new Error("Access token not set")));case 11:return(a=new Headers).append("authorization","Bearer "+s),u=fetch(n,{method:"GET",headers:a,signal:i.getSignal()}),t.abrupt("return",(o.emitEvent(fn.SESSION_POLLING_STARTED),u));case 15:case"end":return t.stop()}}),t)})))},shouldPoll:s,onError:function(e){if(i.isAborted())return{keepPolling:!1};if(e&&(e===ft.FORBIDDEN||e===ft.UNAUTHORIZED))return o.emitError(new Et("User session poller returned FORBIDDEN or UNAUTHORIZED",St.SESSION_ENDED)),o.emitEvent(fn.SESSION_POLLING_STOPPED),{keepPolling:!1};o.emitError(new Et("User session poller failed",St.SESSION_POLLING_FAILED));var t=s();return t||o.emitEvent(fn.SESSION_POLLING_STOPPED),{keepPolling:t}}}),u=!1,c=function(){a.start(),u=!0},d=function(){i.abort(),a.stop(),u&&o.emitEvent(fn.SESSION_POLLING_STOPPED),u=!1};return o.addListener(He(pe),(function(n){!function(t){if(!e){var n=mt(t);n&&(e=n.getUserManager())}}(n);var r=function(e){var n=t,r=At(e);if(r)t=r.state;else if(!t){var i=mt(e);i&&(t=i.getState())}return t!==n}(n),i=Qe(n);i&&(i.type===he.USER_RENEWAL_STARTED&&d(),i.type===he.USER_UPDATED&&i.data&&t===_e.VALID_SESSION&&c()),i&&i.type===he.USER_UPDATED?d():r&&t===_e.VALID_SESSION?c():t!==_e.VALID_SESSION&&d()})),{namespace:ln,start:c,stop:d,connect:function(e){o.storeBeacon(e)}}}function _n(e){var t=e.pollFunction,n=e.pollIntervalInMs,r=void 0===n?1e3:n,i=e.maxRetries,o=void 0===i?10:i;return(0,v.a)(this,void 0,void 0,p().mark((function e(){var n,i,s,a,u,c=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fe(t());case 2:if(n=e.sent,i=n[0],s=n[1],i||!s||!gt(s)){e.next=7;break}return e.abrupt("return",Promise.resolve(s));case 7:if(o){e.next=9;break}return e.abrupt("return",Promise.reject(i));case 9:return u=o,e.abrupt("return",new Promise((function(e,n){(a=vt({pollFunction:function(){return(0,v.a)(c,void 0,void 0,p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t());case 1:case"end":return e.stop()}}),e)})))},onSuccess:function(t){return u=0,e(t),{keepPolling:!1}},onError:function(){var e=(u-=1)>0;return e||n(new Error("Max retries reached")),{keepPolling:e}},shouldPoll:function(){return u>0},pollIntervalInMs:r})).start()})).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.reject(e)})).finally((function(){return a&&a.stop(),void(a=void 0)})));case 11:case"end":return e.stop()}}),e)})))}var hn={API_TOKEN_FETCH_FAILED:"API_TOKEN_FETCH_FAILED",INVALID_API_TOKENS:"INVALID_API_TOKENS",INVALID_USER_FOR_API_TOKENS:"INVALID_USER_FOR_API_TOKENS"},gn=function(e){function t(t,n,r){var i;return(i=e.call(this,t)||this).message=t,i.type=n,i.originalError=r,i.type=n,i.originalError=r,i}return(0,d.Z)(t,e),(0,u.Z)(t,[{key:"isFetchError",get:function(){return this.type===hn.API_TOKEN_FETCH_FAILED}},{key:"isInvalidTokensError",get:function(){return this.type===hn.INVALID_API_TOKENS}},{key:"isInvalidApiTokensUserError",get:function(){return this.type===hn.INVALID_USER_FOR_API_TOKENS}}]),t}((0,a.Z)(Error)),vn="hds_login_api_token_storage_key",mn="hds_login_api_token_user_reference",wn="apiTokensClient",Sn={API_TOKENS_UPDATED:"API_TOKENS_UPDATED",API_TOKENS_RENEWAL_STARTED:"API_TOKENS_RENEWAL_STARTED",API_TOKENS_REMOVED:"API_TOKENS_REMOVED"};function En(e){return(0,v.a)(this,void 0,void 0,p().mark((function t(){var n,r,i,o,s,a,u,c,d,l,f,_,h,g,v,m;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.url,r=e.signal,i=e.accessToken,o=e.maxRetries,s=void 0===o?4:o,a=e.retryInterval,u=void 0===a?500:a,(c=new Headers).append("Authorization","Bearer "+i),d={method:"POST",headers:c,signal:r},t.next=5,fe(_n({pollFunction:function(){return fetch(n,d)},pollIntervalInMs:u,maxRetries:s}));case 5:if(l=t.sent,f=l[0],_=l[1],!f&&_){t.next=10;break}return t.abrupt("return",pt(f)?{}:Promise.resolve(new gn("Network or CORS error occured",hn.API_TOKEN_FETCH_FAILED,f)));case 10:if(_.ok){t.next=15;break}return t.next=13,_.text();case 13:return h=t.sent,t.abrupt("return",Promise.resolve(new gn(h+"."+_.statusText+" Status:"+_.status,hn.API_TOKEN_FETCH_FAILED,f)));case 15:return t.next=17,fe(_.json());case 17:return g=t.sent,v=g[0],m=g[1],t.abrupt("return",v?Promise.resolve(new gn(v.message,hn.INVALID_API_TOKENS,v)):Promise.resolve(m));case 21:case"end":return t.stop()}}),t)})))}var bn=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.sessionStorage).getItem(vn);try{return e?JSON.parse(e):null}catch(e){return null}},kn=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.sessionStorage).removeItem(vn)},yn=function(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.sessionStorage).setItem(vn,JSON.stringify(e))},xn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.sessionStorage,n=bn(t);return n?n[e]:void 0},In=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.sessionStorage).removeItem(mn)},Nn=function(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.sessionStorage).setItem(mn,e)},On=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.sessionStorage).getItem(mn)};function Tn(e){var t=this,n=e.url,r=e.maxRetries,i=e.retryInterval,o=_t(),s=null,a=!1,u=Re(wn),c=function(){kn(sessionStorage),In(sessionStorage),s=null},d=function(e){var t=On();return e.access_token===t?bn(sessionStorage):(c(),null)},l=function(e){return(0,v.a)(t,void 0,void 0,p().mark((function t(){var d,l;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o.abort(),d=e.access_token,a=!0,u.emitEvent(Sn.API_TOKENS_RENEWAL_STARTED,null),t.next=5,En({url:n,accessToken:d,signal:o.getSignal(),maxRetries:r,retryInterval:i});case 5:return l=t.sent,t.abrupt("return",(a=!1,c(),l instanceof Error?(u.emitError(l),Promise.reject(l)):(s=Object.assign({},l),Nn(d),yn(s),u.emitEvent(Sn.API_TOKENS_UPDATED,s),Promise.resolve(s))));case 7:case"end":return t.stop()}}),t)})))};return u.addListener(De(pe),(function(e){return(0,v.a)(t,void 0,void 0,p().mark((function t(){var n,r,i,f;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Qe(e)){t.next=3;break}return t.abrupt("return",Promise.resolve());case 3:if(r=n.type,t.t0=r===he.USER_REMOVED,!t.t0){t.next=11;break}return o.abort(),c(),t.next=10,u.emitEvent(Sn.API_TOKENS_REMOVED,null);case 10:a=!1;case 11:if(r!==he.USER_UPDATED){t.next=24;break}if(!(i=wt(e))){t.next=23;break}if(!(f=d(i))){t.next=19;break}t.t1=(s=f,a=!1,Promise.resolve()),t.next=22;break;case 19:return t.next=21,l(i).catch((function(){}));case 21:t.t1=Promise.resolve();case 22:return t.abrupt("return",t.t1);case 23:u.emitError(new gn("Oidc client event has no valid user",hn.INVALID_USER_FOR_API_TOKENS));case 24:return t.abrupt("return",(r===he.USER_RENEWAL_STARTED&&(a=!0),Promise.resolve()));case 25:case"end":return t.stop()}}),t)})))})),u.addListener(Me(pe),(function(e){var t=wt(e);if(t){var n=d(t);n?(s=n,u.emitEvent(Sn.API_TOKENS_UPDATED,s)):l(t).catch((function(){}))}else s&&c()})),{fetch:l,getTokens:function(){return s},clear:function(){o.abort(),u.emitEvent(Sn.API_TOKENS_REMOVED,null),c()},namespace:wn,connect:function(e){u.storeBeacon(e)},isRenewing:function(){return a}}}var Rn=function(e){var t=e.userManagerSettings,n=e.apiTokensClientSettings,r=e.sessionPollerSettings,i=e.debug,o=e.modules,s=void 0===o?[]:o,a=e.children,u={userManagerSettings:Object.assign({},t),debug:i};return r&&s.push(pn(r)),n&&s.push(Tn(n)),_.createElement(dt,{loginProps:u,modules:s},a)},An=function(){var e=(0,_.useContext)(ct);return{addListener:e.addListener,getModule:e.getModule}},Ln=function(e){return(0,An().getModule)(e)||null},Pn=function(e){var t=(0,_.useContext)(ct).addListener,n=(0,_.useState)(),r=n[0],i=n[1],o=(0,_.useCallback)((function(t){e&&!1===e(t)||i(Object.assign({},t))}),[e,i]),s=(0,_.useCallback)((function(){i(void 0)}),[i]);return(0,_.useLayoutEffect)((function(){return t("*:*",o)}),[o,t]),[r,s]},Cn=function(e,t){var n=(0,_.useMemo)((function(){return"function"==typeof e?e:function(t){return ke(e,t)}}),[]),r=(0,_.useRef)(t),i=!!t,o=(0,_.useCallback)((function(e){if(n(e)){if(!i)return!0;r.current&&r.current(e)}return!1}),[]),s=Pn(o);return i?void 0:s},Un=function(e,t){Cn(e,t)},Dn=function(e){return Cn(e)},Mn=function(){return Dn(Ue())},jn=function(){return(0,(0,_.useContext)(ct).getModule)(pe)},Hn=function(){var e=jn().getUser();return st(e)?e:null},Zn=function(){var e=jn();return(0,_.useState)((function(){return e.getAmr()}))[0]},Fn=function(){var e=jn();return[].concat((0,s.Z)(Dn(Ot)),[e])},Bn={container:"LoginButton-module_container__oCKgh",loginError:"LoginButton-module_loginError__3ehst",icon:"LoginButton-module_icon__m7A2t",text:"LoginButton-module_text__3nZZV"};function qn(e){var t=e.spinnerColor,n=void 0===t?"var(--color-white)":t,r=e.children,i=e.errorText,o=(0,v._)(e,["spinnerColor","children","errorText"]),s=jn().login,a=Hn(),u=Dn(jt)[0],c=Dn(nn),d=c[0],l=c[1],f=Pt(u);if(a)return null;var p=f&&!d,h=p?_.createElement(k.L,{small:!0,style:{"--spinner-color":n}}):void 0,g=Object.assign(Object.assign({},o),{iconLeft:h,disabled:p,onClick:function(){l(),s()}});return _.createElement(_.Fragment,null,_.createElement("div",{className:Bn.container},_.createElement(E.B,Object.assign({},g),r),d&&_.createElement("div",{className:Bn.loginError},_.createElement(b.I,{className:Bn.icon}),_.createElement("span",{className:Bn.text},i))))}function Gn(e){var t=e.children,n=e.onSuccess,r=e.onError,i=jn(),o=i.handleCallback,s=i.getState,a=i.getUser;return s()===_e.NO_SESSION?o().then((function(e){n(e)})).catch((function(e){r(e)})):s()===_e.VALID_SESSION?n(a()):r(new ve("Current state ("+s()+") cannot be handled by a callback",ge.SIGNIN_ERROR)),_.createElement(_.Fragment,null,t)}function Wn(e){var t=e.AuthorisedComponent,n=e.UnauthorisedComponent,r=Hn();return r&&t?_.createElement(t,{user:r}):!r&&n?_.createElement(n,null):null}function Kn(e,t){var n=function(e,n){return _.cloneElement(e,Object.assign(Object.assign({key:n},e.props),{user:t}))};return(0,S.a)(e).map((function(e,r){if(!e)return null;var i=typeof e;if("string"===i||"number"===i)return e;if("function"===i){var o=_.cloneElement(e({user:t}));return n(o,"key-"+r)}return o(e)?n(e,"key-"+r):null}))}function Vn(e){return _.createElement(Wn,{AuthorisedComponent:function(t){return _.createElement(_.Fragment,null,Kn(e.children,t.user))}})}function zn(e){return _.createElement(Wn,{UnauthorisedComponent:function(){return _.createElement(_.Fragment,null,e.children)}})}function Qn(e){return ye(Ue(wn,e))}function Jn(e){return ye(De(wn,e))}function Yn(e,t){return er(e)&&Xe(e,(function(e){return e.type===t}))}function Xn(){return He(wn)}(0,h.s)(".LoginButton-module_container__oCKgh{display:block}.LoginButton-module_loginError__3ehst{display:flex;padding:var(--spacing-m) 0}.LoginButton-module_loginError__3ehst .LoginButton-module_icon__m7A2t,.LoginButton-module_loginError__3ehst .LoginButton-module_text__3nZZV{color:var(--color-error)}");var $n=ye(Xn());function er(e){return ze(e,wn)}function tr(e){var t=e.type,n=e.data,r=void 0===n?null:n,i=Object.assign({type:t},r&&{data:r});return Pe(wn,i)}function nr(e){var t=e.type;return{type:Ne,namespace:wn,payload:{type:t}}}var rr=ye(De(wn));function ir(e){return er(e)?Qe(e):null}function or(e){return!!e&&Yn(e,Sn.API_TOKENS_REMOVED)}function sr(e){return!!e&&Yn(e,Sn.API_TOKENS_RENEWAL_STARTED)}function ar(e){return!!e&&Yn(e,Sn.API_TOKENS_UPDATED)}var ur=Jn(Sn.API_TOKENS_REMOVED),cr=Jn(Sn.API_TOKENS_RENEWAL_STARTED),dr=Jn(Sn.API_TOKENS_UPDATED);function lr(e){return Le(wn,e)}var fr=ye(Ue(wn));function pr(e){return er(e)?Ye(e):null}function _r(e){return er(e)&&$e(e,(function(e){return e.isFetchError}))}function hr(e){return er(e)&&$e(e,(function(e){return e.isInvalidApiTokensUserError}))}function gr(e){return er(e)&&$e(e,(function(e){return e.isInvalidTokensError}))}var vr=Qn(hn.INVALID_API_TOKENS),mr=Qn(hn.API_TOKEN_FETCH_FAILED),wr=Qn(hn.INVALID_USER_FOR_API_TOKENS),Sr=function(){var e=Ln(wn);if(!e)throw new Error("Cannot find apiTokensClient from LoginContext.");return e},Er=function(){var e=Sr(),t=jn();return(0,_.useMemo)((function(){var n=function(){return t.isAuthenticated()?null:new gn("User is not authenticated","INVALID_USER_FOR_API_TOKENS")};return{getStoredApiTokens:function(){var t=n();return t?[t,null]:[null,e.getTokens()]},isRenewing:function(){return!n()&&e.isRenewing()}}}),[e])},br=function(){var e=Sr();return[].concat((0,s.Z)(Dn($n)),[e])};function kr(e){return ye(Ae(Ie,ln,{type:e}))}function yr(e){return ye(Ae(Ne,ln,{type:e}))}function xr(e,t){var n=e?Tr(e):null;return!!n&&n.type===t}function Ir(e){return ze(e,ln)}function Nr(){return He(ln)}var Or=ye(Nr());function Tr(e){return Ir(e)?Qe(e):null}function Rr(e){return Pe(ln,e)}function Ar(e){return!!e&&xr(e,fn.SESSION_POLLING_STARTED)}function Lr(e){return!!e&&xr(e,fn.SESSION_POLLING_STOPPED)}function Pr(){return De(ln)}var Cr=ye(Pr()),Ur=yr(fn.SESSION_POLLING_STOPPED),Dr=yr(fn.SESSION_POLLING_STARTED);function Mr(){return Ue(ln)}function jr(e){return Le(ln,e)}function Hr(e){return Ir(e)?Ye(e):null}function Zr(e){return Ir(e)&&$e(e,(function(e){return e.isSessionEnded}))}function Fr(e){return Ir(e)&&$e(e,(function(e){return e.isSessionPollingFailure}))}var Br=ye(Mr()),qr=kr(St.SESSION_ENDED),Gr=kr(St.SESSION_POLLING_FAILED),Wr=function(){var e=Ln(ln);if(!e)throw new Error("Cannot find sessionPoller from LoginContext.");return e},Kr=function(){var e=Wr();return[].concat((0,s.Z)(Dn(Or)),[e])};function Vr(e){var t=e.userManagerSettings,n=e.apiTokensClientSettings,r=e.sessionPollerSettings,i=e.debug,o=e.modules,s={userManagerSettings:Object.assign({},t),debug:i},a=xe(),u=ut(Object.assign({},s));return a.addSignalContext(u),r&&a.addSignalContext(pn(r)),n&&a.addSignalContext(Tn(n)),o&&o.forEach((function(e){a.addSignalContext(e)})),et(a),a}}}]);
//# sourceMappingURL=6f68a5dc-d9c6e5e6deb54872459b.js.map