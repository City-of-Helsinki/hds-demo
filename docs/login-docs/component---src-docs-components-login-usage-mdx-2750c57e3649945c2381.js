"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[3098],{22175:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return c},default:function(){return f}});var a=t(45987),i=(t(67294),t(64983)),s=t(44186),l=t(88562),r=t(1076),o=t(80699);const d=["components"],c={slug:"/components/login/usage",title:"Login - Usage"},p=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",n)},h=p("IconCheckCircleFill"),k=p("Link"),m=p("IconCrossCircle"),u={_frontmatter:c},g=e=>{let{children:n,pageContext:t}=e;return(0,i.kt)(l.default,{pageContext:t},n)};function f(e){let{components:n}=e,t=(0,a.Z)(e,d);return(0,i.kt)(g,Object.assign({},u,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"usage",style:{position:"relative"}},"Usage",(0,i.kt)("a",{parentName:"h2",href:"#usage","aria-label":"usage permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("h3",{id:"table-of-contents",style:{position:"relative"}},"Table of contents",(0,i.kt)("a",{parentName:"h3",href:"#table-of-contents","aria-label":"table of contents permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#components",mdxType:"InternalLink"},"Components"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#loginprovider",mdxType:"InternalLink"},"LoginProvider")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#loginbutton",mdxType:"InternalLink"},"LoginButton")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#logincallbackhandler",mdxType:"InternalLink"},"LoginCallbackHandler")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#sessionendedhandler",mdxType:"InternalLink"},"SessionEndedHandler")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#withauthentication",mdxType:"InternalLink"},"WithAuthentication")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#withauthenticateduser",mdxType:"InternalLink"},"WithAuthenticatedUser")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#withoutauthenticateduser",mdxType:"InternalLink"},"WithoutAuthenticatedUser")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#hooks",mdxType:"InternalLink"},"Hooks"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useoidcclient",mdxType:"InternalLink"},"useOidcClient")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useauthenticateduser",mdxType:"InternalLink"},"useAuthenticatedUser")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#usecachedamr",mdxType:"InternalLink"},"useCachedAmr")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useoidcclienttracking",mdxType:"InternalLink"},"useOidcClientTracking")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useapitokensclient",mdxType:"InternalLink"},"useApiTokensClient")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useapitokens",mdxType:"InternalLink"},"useApiTokens")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useapitokensclienttracking",mdxType:"InternalLink"},"useApiTokensClientTracking")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#usesessionpoller",mdxType:"InternalLink"},"useSessionPoller")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#usesessionpollertracking",mdxType:"InternalLink"},"useSessionPollerTracking")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#usesignallistener",mdxType:"InternalLink"},"useSignalListener")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#usesignaltrackingwithreturnvalue",mdxType:"InternalLink"},"useSignalTrackingWithReturnValue")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#usesignaltrackingwithcallback",mdxType:"InternalLink"},"useSignalTrackingWithCallback")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#modules",mdxType:"InternalLink"},"Modules"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#oidc-client",mdxType:"InternalLink"},"Oidc Client")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#api-tokens-client",mdxType:"InternalLink"},"Api tokens client")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#session-poller",mdxType:"InternalLink"},"Session poller")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#silent-renewal",mdxType:"InternalLink"},"Silent renewal")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#signals",mdxType:"InternalLink"},"Signals"))),(0,i.kt)("h3",{id:"components",style:{position:"relative"}},"Components",(0,i.kt)("a",{parentName:"h3",href:"#components","aria-label":"components permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"HDS login components cover most use cases and also handle errors when logging in or getting tokens."),(0,i.kt)("p",null,"Detailed information about all properties of each component is listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#components",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"important",style:{position:"relative"}},"Important",(0,i.kt)("a",{parentName:"h4",href:"#important","aria-label":"important permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"All components and hooks require a ",(0,i.kt)(r.Z,{href:"/components/login/usage#loginprovider",mdxType:"InternalLink"},"LoginProvider")," to provide context for them."),(0,i.kt)("h4",{id:"loginprovider",style:{position:"relative"}},"LoginProvider",(0,i.kt)("a",{parentName:"h4",href:"#loginprovider","aria-label":"loginprovider permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"This component creates a React context and initialises all modules. All components and hooks are required to render inside the LoginProvider or React Context will throw an error."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"const providerProperties: LoginProviderProps = {\n  userManagerSettings: {\n    authority: 'https://tunnistamo.dev.hel.ninja/',\n    client_id: 'exampleapp-ui-dev',\n    scope: 'openid profile email',\n    redirect_uri: 'https://service.fi/callback',\n  },\n  apiTokensClientSettings: { url: 'https://tunnistamo.dev.hel.ninja/api-tokens/' },\n  sessionPollerSettings: { pollIntervalInMs: 300000 },\n};\n\nconst MyApp = () => {\n  const { isAuthenticated, getUser, logout } = useOidcClient();\n  const { getApiTokens } = useApiTokens();\n  const { addListener } = useSignalListener();\n  if (isAuthenticated()) {\n    return (\n      <>\n        <p>Hello, {user.name}!</p>\n        <Button onClick={() => logout()}>Log out</Button>\n      </>\n    );\n  } else {\n    return (\n      <>\n        <p>You are not logged in.</p>\n        <LoginButton errorText=\"Login failed. Try again!\">Log in</LoginButton>\n      </>\n    );\n  }\n};\n\n<LoginProvider {...providerProperties}>\n  <MyApp />\n</LoginProvider>;\n"))),(0,i.kt)("p",null,"All component properties are listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#loginprovider",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"loginbutton",style:{position:"relative"}},"LoginButton",(0,i.kt)("a",{parentName:"h4",href:"#loginbutton","aria-label":"loginbutton permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"This component handles the redirection to the OIDC server and also errors if the server rejects the request for ",(0,i.kt)(o.Z,{href:"https://tunnistamo.dev.hel.ninja/.well-known/openid-configuration",mdxType:"ExternalLink"},"OpenID configuration"),"."),(0,i.kt)("p",null,"Button text is passed and rendered as a child."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},'<LoginButton errorText="Login failed. Try again!">Log in</LoginButton>\n'))),(0,i.kt)("p",null,"All component properties are listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#loginbutton",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"logincallbackhandler",style:{position:"relative"}},"LoginCallbackHandler",(0,i.kt)("a",{parentName:"h4",href:"#logincallbackhandler","aria-label":"logincallbackhandler permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"This component handles the response, when the OIDC server redirects the browser back to the given callback route. When the response is parsed, the browser is usually redirected to another path."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"const onSuccess = (user: User) => {\n  // handle successful login\n  // usually redirect to a page\n};\nconst onError = (error: OidcClientError) => {\n  // handle error\n};\nreturn (\n  <LoginProvider {...providerProperties}>\n    <LoginCallbackHandler onSuccess={onSuccess} onError={onError}>\n      <div>Logging in...</div>\n    </LoginCallbackHandler>\n  </LoginProvider>\n);\n"))),(0,i.kt)("p",null,"All component properties are listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#logincallbackhandler",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"sessionendedhandler",style:{position:"relative"}},"SessionEndedHandler",(0,i.kt)("a",{parentName:"h4",href:"#sessionendedhandler","aria-label":"sessionendedhandler permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"This component listens to the session ended signal. It is emitted from the Session poller, if it receives a response indicating the user's session has ended.\nThen the component shows a HDS Dialog and forces the user to logout. The Dialog can be seen in the ",(0,i.kt)(o.Z,{href:"/storybook/react/?path=/story/components-login--example-application",mdxType:"ExternalLink"},"Storybook"),"."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"<SessionEndedHandler\n  content={{\n    title: 'Session has ended!',\n    text: 'Your session on the server has ended. You will be logged out in this window too.',\n    buttonText: 'Logout',\n    closeButtonLabelText: 'Logout',\n  }}\n/>\n"))),(0,i.kt)("p",null,"All component properties are listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#sessionendedhandler",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"withauthentication",style:{position:"relative"}},"WithAuthentication",(0,i.kt)("a",{parentName:"h4",href:"#withauthentication","aria-label":"withauthentication permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Component for rendering child components conditionally, depending on is user authenticated or not."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},'const HelloUser = ({ user }: { user: User }) => {\n  return <p>Hello, {user.name}!</p>;\n};\n\nconst LoginComponent = () => {\n  return <LoginButton errorText="Login failed. Try again!">Log in</LoginButton>;\n};\n\n<WithAuthentication AuthorisedComponent={HelloUser} UnauthorisedComponent={LoginComponent} />;\n'))),(0,i.kt)("p",null,"All component properties are listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#withauthentication",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"withauthenticateduser",style:{position:"relative"}},"WithAuthenticatedUser",(0,i.kt)("a",{parentName:"h4",href:"#withauthenticateduser","aria-label":"withauthenticateduser permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Renders its children only, if the user is authenticated. Uses ",(0,i.kt)("inlineCode",{parentName:"p"},"WithAuthentication"),"."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"<WithAuthenticatedUser>\n  <p>This is rendered, if the user is authenticated</p>\n</WithAuthenticatedUser>\n"))),(0,i.kt)("p",null,"All component properties are listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#withauthenticateduser",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"withoutauthenticateduser",style:{position:"relative"}},"WithoutAuthenticatedUser",(0,i.kt)("a",{parentName:"h4",href:"#withoutauthenticateduser","aria-label":"withoutauthenticateduser permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Renders its children only, if the user is not authenticated. Uses ",(0,i.kt)("inlineCode",{parentName:"p"},"WithAuthentication"),"."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"<WithoutAuthenticatedUser>\n  <p>This is rendered, if the user is not authenticated</p>\n</WithoutAuthenticatedUser>\n"))),(0,i.kt)("p",null,"All component properties are listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#withoutauthenticateduser",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h3",{id:"hooks",style:{position:"relative"}},"Hooks",(0,i.kt)("a",{parentName:"h3",href:"#hooks","aria-label":"hooks permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("h4",{id:"oidc-client-hooks",style:{position:"relative"}},"Oidc client hooks",(0,i.kt)("a",{parentName:"h4",href:"#oidc-client-hooks","aria-label":"oidc client hooks permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Detailed information about Oidc client hooks is listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#oidc-client-hooks",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h5",{id:"useoidcclient",style:{position:"relative"}},"useOidcClient",(0,i.kt)("a",{parentName:"h5",href:"#useoidcclient","aria-label":"useoidcclient permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Returns the ",(0,i.kt)(r.Z,{href:"/components/login/usage#oidc-client",mdxType:"InternalLink"},"Oidc client module"),"."),(0,i.kt)("h5",{id:"useauthenticateduser",style:{position:"relative"}},"useAuthenticatedUser",(0,i.kt)("a",{parentName:"h5",href:"#useauthenticateduser","aria-label":"useauthenticateduser permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Returns a user object, if the object is valid, authenticated and passes the ",(0,i.kt)(r.Z,{href:"/components/login/api#other-exported-utility-functions",mdxType:"InternalLink"},"isValidUser()")," check."),(0,i.kt)("h5",{id:"usecachedamr",style:{position:"relative"}},"useCachedAmr",(0,i.kt)("a",{parentName:"h5",href:"#usecachedamr","aria-label":"usecachedamr permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Returns the user's amr value. It is cached because in some cases it must be decrypted from a ",(0,i.kt)("inlineCode",{parentName:"p"},"id_token"),"."),(0,i.kt)("h5",{id:"useoidcclienttracking",style:{position:"relative"}},"useOidcClientTracking",(0,i.kt)("a",{parentName:"h5",href:"#useoidcclienttracking","aria-label":"useoidcclienttracking permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Returns an array of ",(0,i.kt)("inlineCode",{parentName:"p"},"[signal, reset function, oidcClient instance]"),". The hook re-renders the component each time the client emits a signal."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"import { useOidcClient, useOidcClientTracking, useAuthenticatedUser, useCachedAmr } from 'hds-react';\n\nconst OidcClientHooks = () => {\n  const client = useOidcClient();\n  const [lastSignal, reset, oidcClient] = useOidcClientTracking();\n  const user = useAuthenticatedUser();\n  const amr = useCachedAmr();\n  if (user) {\n    return <p>Your amr is: {amr ? amr[0] : 'none'}</p>;\n  } else {\n    return (\n      <Button\n        onClick={() => {\n          client.login();\n        }}\n      >\n        Log in!\n      </Button>\n    );\n  }\n};\n"))),(0,i.kt)("h3",{id:"api-tokens-client-hooks",style:{position:"relative"}},"Api tokens client hooks",(0,i.kt)("a",{parentName:"h3",href:"#api-tokens-client-hooks","aria-label":"api tokens client hooks permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Detailed information about Api tokens client hooks is listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#api-tokens-client-hooks",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"useapitokensclient",style:{position:"relative"}},"useApiTokensClient",(0,i.kt)("a",{parentName:"h4",href:"#useapitokensclient","aria-label":"useapitokensclient permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Returns the ",(0,i.kt)(r.Z,{href:"/components/login/usage#api-tokens-client",mdxType:"InternalLink"}," Api tokens client module"),"."),(0,i.kt)("h4",{id:"useapitokens",style:{position:"relative"}},"useApiTokens",(0,i.kt)("a",{parentName:"h4",href:"#useapitokens","aria-label":"useapitokens permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Returns functions for checking tokens and status of renewal."),(0,i.kt)("h4",{id:"useapitokensclienttracking",style:{position:"relative"}},"useApiTokensClientTracking",(0,i.kt)("a",{parentName:"h4",href:"#useapitokensclienttracking","aria-label":"useapitokensclienttracking permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Returns an array of ",(0,i.kt)("inlineCode",{parentName:"p"},"[signal, reset function, apiTokensClient instance]"),". The hook re-render the component each time the client emits a signal."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"import { useApiTokensClient, useApiTokens, useApiTokensClientTracking } from 'hds-react';\n\nconst ApiTokensClientHooks = () => {\n  const client = useApiTokensClient();\n  const { getStoredApiTokens, isRenewing } = useApiTokens();\n  const [lastSignal, reset, apiTokensClient] = useApiTokensClientTracking();\n  if (isRenewing()) {\n    return <p>Your api tokens are being renewed!</p>;\n  }\n  if (getStoredApiTokens()) {\n    return <p>You have api tokens!</p>;\n  }\n};\n"))),(0,i.kt)("h3",{id:"session-poller-hooks",style:{position:"relative"}},"Session poller hooks",(0,i.kt)("a",{parentName:"h3",href:"#session-poller-hooks","aria-label":"session poller hooks permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Detailed information about Session poller hooks is listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#session-poller",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"usesessionpoller",style:{position:"relative"}},"useSessionPoller",(0,i.kt)("a",{parentName:"h4",href:"#usesessionpoller","aria-label":"usesessionpoller permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Returns the ",(0,i.kt)(r.Z,{href:"/components/login/usage#session-poller",mdxType:"InternalLink"}," Session poller module"),"."),(0,i.kt)("h4",{id:"usesessionpollertracking",style:{position:"relative"}},"useSessionPollerTracking",(0,i.kt)("a",{parentName:"h4",href:"#usesessionpollertracking","aria-label":"usesessionpollertracking permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Returns an array of ",(0,i.kt)("inlineCode",{parentName:"p"},"[signal, reset function, sessionPoller instance]"),". The hook re-renders the component each time the client emits a signal."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"import { useSessionPoller, useSessionPollerTracking } from 'hds-react';\n\nconst SessionPollerHooks = () => {\n  const poller = useSessionPoller();\n  const [lastSignal, reset, sessionPoller] = useSessionPollerTracking();\n  if (isSessionPollerStoppedSignal(lastSignal)) {\n    <Button\n      onClick={() => {\n        poller.start();\n      }}\n    >\n      Start polling!\n    </Button>;\n  }\n};\n"))),(0,i.kt)("h3",{id:"generic-signal-hooks",style:{position:"relative"}},"Generic signal hooks",(0,i.kt)("a",{parentName:"h3",href:"#generic-signal-hooks","aria-label":"generic signal hooks permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Hooks are the easiest way to listen to signals. Most hooks return the last triggered signal and re-renders the component. Re-rendering is done only if the listener returns true. So listeners added by hooks must return a boolean."),(0,i.kt)("p",null,"Hooks dispose of the listeners when the component unmounts. Hooks cannot emit signals."),(0,i.kt)("p",null,"Detailed information about these hooks is listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#generic-signal-hooks",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"usesignallistener",style:{position:"relative"}},"useSignalListener",(0,i.kt)("a",{parentName:"h4",href:"#usesignallistener","aria-label":"usesignallistener permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Adds a single listener for all signals."),(0,i.kt)("h4",{id:"usesignaltrackingwithreturnvalue",style:{position:"relative"}},"useSignalTrackingWithReturnValue",(0,i.kt)("a",{parentName:"h4",href:"#usesignaltrackingwithreturnvalue","aria-label":"usesignaltrackingwithreturnvalue permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Creates a trigger from given props and re-renders the component if any emitted signals match the trigger."),(0,i.kt)("h4",{id:"usesignaltrackingwithcallback",style:{position:"relative"}},"useSignalTrackingWithCallback",(0,i.kt)("a",{parentName:"h4",href:"#usesignaltrackingwithcallback","aria-label":"usesignaltrackingwithcallback permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Creates a trigger from given props and calls the callback function if any emitted signals match the trigger."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Important!")," The listener passed to ",(0,i.kt)("inlineCode",{parentName:"p"},"useSignalListener")," must be memoized or the hook will attach a new listener on each render because the props changed. The old one is disposed but to avoid unnecessary listeners, use memoization with ",(0,i.kt)("inlineCode",{parentName:"p"},"useMemo")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"useCallback"),".\nNote that all ",(0,i.kt)("inlineCode",{parentName:"p"},"triggerFor...")," functions are constants and do not need memoization."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"useSignalTrackingWithReturnValue")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"useSignalTrackingWithCallback")," store their arguments to React refs, so memoization is not needed."),(0,i.kt)("p",null,"The array returned by the ",(0,i.kt)("inlineCode",{parentName:"p"},"useSignalListener")," and the ",(0,i.kt)("inlineCode",{parentName:"p"},"useSignalTrackingWithReturnValue")," have the last signal, if any, and a reset function that clears the last signal. This can be used for tracking certain errors and then resetting the array, when the user has seen a notification about the error."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"import {\n  useSignalListener,\n  useSignalListenerWithReturnValue,\n  triggerForAllSessionPollerErrors,\n  isSessionEndedSignal,\n} from 'hds-react';\n\nconst ListenerComponent = () => {\n  const [ showDialog, setShowDialog ] = useState(false);\n    // listener function must be memoized when useSignalListener is used!\n  const myListener = useCallback(( signal )=>{\n    if( isSessionEndedSignal(signal) ){\n      setShowDialog(true)\n    }\n  },[]);\n  useSignalListener(myListener);\n  if ( showDialog ) {\n    return <Dialog ... />\n  }\n};\n\nconst ListenerComponentWithReturnValue = () => {\n  const [showDialog, setShowDialog] = useState(false);\n  const [sessionEndedSignal] = useSignalTrackingWithReturnValue(triggerForAllSessionPollerErrors);\n  if(isSessionEndedSignal(sessionEndedSignal)){\n    setShowDialog(true)\n  }\n  if (showDialog) {\n    return <Dialog ... />\n  }\n};\n"))),(0,i.kt)("p",null,"Properties and methods of all hooks are listed on the ",(0,i.kt)(r.Z,{href:"/components/login/usage#components",mdxType:"InternalLink"},"API")," page."),(0,i.kt)("h3",{id:"modules",style:{position:"relative"}},"Modules",(0,i.kt)("a",{parentName:"h3",href:"#modules","aria-label":"modules permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Modules are automatically created by the LoginProvider. Module settings are included in the LoginProvider settings and passed to each module."),(0,i.kt)("p",null,"Properties, methods, errors and signals of all modules are listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#modules",mdxType:"InternalLink"},"API")," page."),(0,i.kt)("h4",{id:"oidc-client",style:{position:"relative"}},"Oidc client",(0,i.kt)("a",{parentName:"h4",href:"#oidc-client","aria-label":"oidc client permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"The Oidc client settings are defined in the ",(0,i.kt)("inlineCode",{parentName:"p"},"userManagerSettings")," property which is passed to the LoginProvider."),(0,i.kt)("p",null,"The module is exposed with the ",(0,i.kt)(r.Z,{href:"/components/login/usage#useoidcclient",mdxType:"InternalLink"},"useOidcClient")," hook."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"import { useOidcClient } from 'hds-react';\n\nconst LogoutComponent = () => {\n  const { logout } = useOidcClient();\n  return <Button onClick={() => logout()}>Log out</Button>;\n};\n"))),(0,i.kt)("h5",{id:"requirements",style:{position:"relative"}},"Requirements",(0,i.kt)("a",{parentName:"h5",href:"#requirements","aria-label":"requirements permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Usage of the Oidc client requires"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"an OIDC provider"),(0,i.kt)("li",{parentName:"ul"},"at least client id, authority, scope and registered callback URLs for it."),(0,i.kt)("li",{parentName:"ul"},'silent_renew.html for silent token renewal. This is a poorly documented feature in the oidc-client-ts. This file has a javascript snippet which communicates with the oidc provider "silently" in a hidden iframe.\nMore about ',(0,i.kt)(o.Z,{href:"https://www.oauth.com/oauth2-servers/access-tokens/refreshing-access-tokens/",mdxType:"ExternalLink"},"token renewal"),". An example can be found in ",(0,i.kt)(r.Z,{href:"/components/login/usage#silent-renewal",mdxType:"InternalLink"},"Silent renew"),".")),(0,i.kt)("h5",{id:"api",style:{position:"relative"}},"API",(0,i.kt)("a",{parentName:"h5",href:"#api","aria-label":"api permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"All Oidc Client settings, properties, methods and signals are detailed on the API page:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#settings",mdxType:"InternalLink"},"module settings")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#default-usermanager-settings",mdxType:"InternalLink"},"default UserManager settings")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#methods",mdxType:"InternalLink"},"methods")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#state-change-signals",mdxType:"InternalLink"},"state change signals")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#event-signals",mdxType:"InternalLink"},"event signals")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#error-signal-types",mdxType:"InternalLink"},"error signal types")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#dedicated-signal-triggers",mdxType:"InternalLink"},"dedicated signal triggers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#getting-signal-payloads",mdxType:"InternalLink"},"getting signal payloads")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#other-exported-utility-functions",mdxType:"InternalLink"},"utility functions"))),(0,i.kt)("h5",{id:"hooks-1",style:{position:"relative"}},"Hooks",(0,i.kt)("a",{parentName:"h5",href:"#hooks-1","aria-label":"hooks 1 permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useoidcclient",mdxType:"InternalLink"},"useOidcClient")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useauthenticateduser",mdxType:"InternalLink"},"useAuthenticatedUser")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#usecachedamr",mdxType:"InternalLink"},"useCachedAmr")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useoidcclienttracking",mdxType:"InternalLink"},"useOidcClientTracking"))),(0,i.kt)("p",null,"Detailed information about Oidc client hooks is listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#oidc-client-hooks",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"api-tokens-client",style:{position:"relative"}},"Api tokens client",(0,i.kt)("a",{parentName:"h4",href:"#api-tokens-client","aria-label":"api tokens client permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"The api tokens client listens to the Oidc client signals and waits until the user is authenticated and then fetches the api tokens. It retries if fetch fails and terminates when max retries are reached.\nWhen the user is expiring and renews, api tokens are also renewed automatically."),(0,i.kt)("h5",{id:"requirements-1",style:{position:"relative"}},"Requirements",(0,i.kt)("a",{parentName:"h5",href:"#requirements-1","aria-label":"requirements 1 permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"URL where to get the tokens from. A user's access token is also required, so the user must be authenticated to fetch api tokens."),(0,i.kt)("h5",{id:"api-1",style:{position:"relative"}},"API",(0,i.kt)("a",{parentName:"h5",href:"#api-1","aria-label":"api 1 permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"All Api token client settings, properties, methods and signals are detailed on the API page:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#settings-1",mdxType:"InternalLink"},"module settings")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#methods-1",mdxType:"InternalLink"},"methods")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#other-exported-utility-functions-1",mdxType:"InternalLink"},"utility functions")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#event-signals-1",mdxType:"InternalLink"},"event signals")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#error-signal-types-1",mdxType:"InternalLink"},"error signal types")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#dedicated-signal-triggers-1",mdxType:"InternalLink"},"dedicated signal triggers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#getting-signal-payloads-1",mdxType:"InternalLink"},"getting signal payloads"))),(0,i.kt)("h5",{id:"hooks-2",style:{position:"relative"}},"Hooks",(0,i.kt)("a",{parentName:"h5",href:"#hooks-2","aria-label":"hooks 2 permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useapitokensclient",mdxType:"InternalLink"},"useApiTokensClient")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useapitokens",mdxType:"InternalLink"},"useApiTokens")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#useapitokensclienttracking",mdxType:"InternalLink"},"useApiTokensClientTracking"))),(0,i.kt)("p",null,"Detailed information about Api token client hooks is listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#api-tokens-client-hooks",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h4",{id:"session-poller",style:{position:"relative"}},"Session poller",(0,i.kt)("a",{parentName:"h4",href:"#session-poller","aria-label":"session poller permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"The user's session could end outside of the current browser window. The Session poller calls the userinfo endpoint and notifies when it receives an unauthorized or forbidden response.\nSuccesses and other errors are ignored."),(0,i.kt)("h5",{id:"requirements-2",style:{position:"relative"}},"Requirements",(0,i.kt)("a",{parentName:"h5",href:"#requirements-2","aria-label":"requirements 2 permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Polling requires a user and the userManager from the Oidc client. The polling endpoint is fetched from userManager's metadata."),(0,i.kt)("h5",{id:"api-2",style:{position:"relative"}},"API",(0,i.kt)("a",{parentName:"h5",href:"#api-2","aria-label":"api 2 permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"All Session poller settings, properties, methods and signals are detailed on the API page:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#settings-2",mdxType:"InternalLink"},"module settings")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#methods-2",mdxType:"InternalLink"},"methods")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#other-exported-utility-functions-2",mdxType:"InternalLink"},"utility functions")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#event-signals-2",mdxType:"InternalLink"},"event signals")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#error-signal-types-2",mdxType:"InternalLink"},"error signal types")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#dedicated-signal-triggers-2",mdxType:"InternalLink"},"dedicated signal triggers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/api#getting-signal-payloads-2",mdxType:"InternalLink"},"getting signal payloads"))),(0,i.kt)("h5",{id:"hooks-3",style:{position:"relative"}},"Hooks",(0,i.kt)("a",{parentName:"h5",href:"#hooks-3","aria-label":"hooks 3 permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#usesessionpoller",mdxType:"InternalLink"},"useSessionPoller")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)(r.Z,{href:"/components/login/usage#usesessionpollertracking",mdxType:"InternalLink"},"useSessionPollerTracking"))),(0,i.kt)("p",null,"Detailed information about Session poller hooks is listed on the ",(0,i.kt)(r.Z,{href:"/components/login/api#session-poller-hooks",mdxType:"InternalLink"},"API page"),"."),(0,i.kt)("h5",{id:"silent-renewal",style:{position:"relative"}},"Silent renewal",(0,i.kt)("a",{parentName:"h5",href:"#silent-renewal","aria-label":"silent renewal permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"The ",(0,i.kt)(o.Z,{href:"https://github.com/authts/oidc-client-ts",mdxType:"ExternalLink"},"oidc-client-ts")," uses ",(0,i.kt)("inlineCode",{parentName:"p"},"silent_renew.html "),"for user token renewal. Save this file to your server and place to url to settings as ",(0,i.kt)("inlineCode",{parentName:"p"},"silent_redirect_uri"),"."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'<!DOCTYPE html>\n<html lang="en">\n  <head>\n    <title>Silent renewal</title>\n  </head>\n  <body>\n    <script\n      src="https://cdnjs.cloudflare.com/ajax/libs/oidc-client-ts/2.2.2/browser/oidc-client-ts.min.js"\n      integrity="sha512-pt8b5O4w5Y9/xZpIhPN8Soo/YbC95SxHn0P/Mu39iYB2Ih/09TMS3Id5XPqve2f8DPC6voXOzgQNojCuqO6A4w=="\n      crossorigin="anonymous"\n      referrerpolicy="no-referrer"\n    ><\/script>\n    <script>\n      var mgr = new oidc.UserManager({});\n      mgr.signinSilentCallback().catch(error => {\n        console.error(\'silent_renew.html error\', error);\n      });\n    <\/script>\n  </body>\n</html>\n'))),(0,i.kt)("h3",{id:"signals",style:{position:"relative"}},"Signals",(0,i.kt)("a",{parentName:"h3",href:"#signals","aria-label":"signals permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Signals can be listened to with hooks. Each module has its own hook for listening to signals only from that module. There are also hooks for listening to all signals and filtering is possible with triggers."),(0,i.kt)("p",null,"Detailed information is in the ",(0,i.kt)(r.Z,{href:"/components/login/api#signals",mdxType:"InternalLink"},"API")," section."),(0,i.kt)("h4",{id:"listening-to-signals",style:{position:"relative"}},"Listening to signals",(0,i.kt)("a",{parentName:"h4",href:"#listening-to-signals","aria-label":"listening to signals permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"A signal listener is a function which receives one argument: the signal. A listener can listen to all signals or just one type or signal with a certain namespace.\nListeners can be even more specific and listen to signals with certain payloads. In short, a listener can listen to any properties of the signal and is triggered when all properties match."),(0,i.kt)("p",null,"The listener is called only if the emitted signal matches the given props."),(0,i.kt)("p",null,"For example, if the trigger props (first argument) passed to ",(0,i.kt)("inlineCode",{parentName:"p"},"beacon.addListener(trigger, listener)")," is ",(0,i.kt)("inlineCode",{parentName:"p"},"{ type:'error' }"),", the listener (second argument) is called when the emitted signal has a matching type. It does not matter what other props the signal has."),(0,i.kt)("p",null,"If the trigger props are ",(0,i.kt)("inlineCode",{parentName:"p"},"{ namespace:'myModule', payload:{type:'click'} }"),", the emitted signal must have those properties with the same, exact values. Other properties are not checked."),(0,i.kt)("p",null,"The trigger can also be a function. Internally all triggers are converted to functions."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"const listener = (signal) => {\n  // do something with the signal.\n};\n// listen to all error signals\nconst trigger = { type: 'error' };\nuseSignalTrackingWithCallback(trigger, listener);\n"))),(0,i.kt)("h3",{id:"getting-signal-payloads",style:{position:"relative"}},"Getting signal payloads",(0,i.kt)("a",{parentName:"h3",href:"#getting-signal-payloads","aria-label":"getting signal payloads permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"Sometimes the significant part of a signal is the payload. There are predefined payload getters for the Oidc client.\nIf the given signal is not from Oidc client or is not the given type, the function returns null. So there is no need to pre-check the signal namespace or type."),(0,i.kt)(s.ZP,{mdxType:"PlaygroundPreview"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"import {\n  useSignalListenerWithReturnValue,\n  triggerForAllOidcClientSignals,\n  getOidcClientStateChangePayload,\n  oidcClientStates,\n} from 'hds-react';\n\nconst StateChangeIndicator = () => {\n  const [lastSignal, reset] = useSignalListenerWithReturnValue(triggerForAllOidcClientSignals);\n  const payload = lastSignal ? getOidcClientStateChangePayload(lastSignal) : null;\n  if (payload && payload.state === oidcClientStates.LOGGING_OUT) {\n    return <p>Logging out....</p>;\n  }\n};\n"))),(0,i.kt)("h2",{id:"using-without-react",style:{position:"relative"}},"Using without React",(0,i.kt)("a",{parentName:"h2",href:"#using-without-react","aria-label":"using without react permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("p",null,"When React is not used, the beacon and modules can be created and initialized with ",(0,i.kt)("inlineCode",{parentName:"p"},"createLoginSystem(props)"),". Props are the same as passed to ",(0,i.kt)(r.Z,{href:"/components/login/usage#loginprovider",mdxType:"InternalLink"},"LoginProvider"),". The function returns a ",(0,i.kt)(r.Z,{href:"/components/login/api#beacon",mdxType:"InternalLink"},"beacon")," instance which holds all modules.\nThere are dozens of utility functions to use without React. See ",(0,i.kt)(r.Z,{href:"/components/login/api#modules",mdxType:"InternalLink"},"modules")," and ",(0,i.kt)(r.Z,{href:"/components/login/api#signals",mdxType:"InternalLink"},"signals"),"."),(0,i.kt)("h2",{id:"packages",style:{position:"relative"}},"Packages",(0,i.kt)("a",{parentName:"h2",href:"#packages","aria-label":"packages permalink",className:"header-anchor after"},(0,i.kt)("span",{parentName:"a",className:"hds-anchor-icon hds-icon hds-icon--link hds-icon--size-xs","aria-hidden":"true",style:{verticalAlign:"middle"}}))),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Package"),(0,i.kt)("th",{parentName:"tr",align:null},"Included"),(0,i.kt)("th",{parentName:"tr",align:null},"Storybook link"),(0,i.kt)("th",{parentName:"tr",align:null},"Source link"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"HDS React")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("div",{style:{display:"flex",gap:"var(--spacing-3-xs)"}},(0,i.kt)(h,{mdxType:"IconCheckCircleFill"})," Yes ")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)(k,{size:"M",openInNewTab:!0,openInNewTabAriaLabel:"Opens in a new tab",href:"/storybook/react/?path=/story/components-login--example-application",mdxType:"Link"},"View in Storybook")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)(o.Z,{size:"M",openInExternalDomainAriaLabel:"Opens in a new domain",openInNewTab:!0,openInNewTabAriaLabel:"Opens in a new tab",href:"https://github.com/City-of-Helsinki/helsinki-design-system/blob/master/packages/react/src/components/login",mdxType:"ExternalLink"},"View source"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"HDS Core")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("div",{style:{display:"flex",gap:"var(--spacing-3-xs)"}},(0,i.kt)(m,{mdxType:"IconCrossCircle"})," No ")),(0,i.kt)("td",{parentName:"tr",align:null},"-"),(0,i.kt)("td",{parentName:"tr",align:null},"-")))))}f.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-docs-components-login-usage-mdx-2750c57e3649945c2381.js.map